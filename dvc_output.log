Verifying data sources in stage: 'data/raw.dvc'

Running stage 'prepare':
> python3.11 a_guide_to_mlops/prepare.py data/raw data/prepared
Found 1637 files belonging to 11 classes.
Using 1310 files for training.
Using 327 files for validation.
2024-11-13 22:12:30.177103: I tensorflow/core/framework/local_rendezvous.cc:405] Local rendezvous is aborting with status: OUT_OF_RANGE: End of sequence
Attempting to load saved datasets to verify...
Successfully loaded datasets from data/prepared/train and data/prepared/test

Dataset saved at /Users/fabien/Library/CloudStorage/GoogleDrive-roth.fabien@gmail.com/My Drive/MSC_Datascience/02 - Courses/TSM-MachLeData/a-guide-to-mlops/data/prepared
Updating lock file 'dvc.lock'

Running stage 'baseline_train':
> python3.11 a_guide_to_mlops/train/baseline/train.py data/prepared model/baseline
Script started...
Command Line Arguments: ['a_guide_to_mlops/train/baseline/train.py', 'data/prepared', 'model/baseline']
Prepared Dataset Folder Path: /Users/fabien/Library/CloudStorage/GoogleDrive-roth.fabien@gmail.com/My Drive/MSC_Datascience/02 - Courses/TSM-MachLeData/a-guide-to-mlops/data/prepared
Model Folder Path: /Users/fabien/Library/CloudStorage/GoogleDrive-roth.fabien@gmail.com/My Drive/MSC_Datascience/02 - Courses/TSM-MachLeData/a-guide-to-mlops/model/baseline
Loading datasets...
Datasets loaded successfully.
Loading labels from /Users/fabien/Library/CloudStorage/GoogleDrive-roth.fabien@gmail.com/My Drive/MSC_Datascience/02 - Courses/TSM-MachLeData/a-guide-to-mlops/data/prepared/labels.json
Defining model...
/Users/fabien/Library/CloudStorage/GoogleDrive-roth.fabien@gmail.com/My Drive/MSC_Datascience/02 - Courses/TSM-MachLeData/a-guide-to-mlops/.venv/lib/python3.11/site-packages/keras/src/layers/convolutional/base_conv.py:107: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
Model: "sequential"
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ Layer (type)                    â”ƒ Output Shape           â”ƒ       Param # â”ƒ
â”¡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”©
â”‚ conv2d (Conv2D)                 â”‚ (None, 30, 30, 64)     â”‚           640 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ max_pooling2d (MaxPooling2D)    â”‚ (None, 10, 10, 64)     â”‚             0 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ flatten (Flatten)               â”‚ (None, 6400)           â”‚             0 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ dense (Dense)                   â”‚ (None, 128)            â”‚       819,328 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ dense_1 (Dense)                 â”‚ (None, 11)             â”‚         1,419 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
 Total params: 821,387 (3.13 MB)
 Trainable params: 821,387 (3.13 MB)
 Non-trainable params: 0 (0.00 B)
Starting training...
Epoch 1/10
[1m 1/41[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m23s[0m 593ms/step - loss: 2.4014 - sparse_categorical_accuracy: 0.1250[1m 4/41[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 2.3643 - sparse_categorical_accuracy: 0.1400  [1m 7/41[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 2.3591 - sparse_categorical_accuracy: 0.1396[1m10/41[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 2.3544 - sparse_categorical_accuracy: 0.1332[1m14/41[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 17ms/step - loss: 2.3434 - sparse_categorical_accuracy: 0.1274[1m17/41[0m [32mâ”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 17ms/step - loss: 2.3336 - sparse_categorical_accuracy: 0.1294[1m20/41[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 17ms/step - loss: 2.3236 - sparse_categorical_accuracy: 0.1339[1m23/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 2.3135 - sparse_categorical_accuracy: 0.1398[1m26/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 2.3039 - sparse_categorical_accuracy: 0.1451[1m29/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 2.2942 - sparse_categorical_accuracy: 0.1521[1m32/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 2.2836 - sparse_categorical_accuracy: 0.1603[1m35/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”[0m [1m0s[0m 18ms/step - loss: 2.2721 - sparse_categorical_accuracy: 0.1689[1m38/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 18ms/step - loss: 2.2598 - sparse_categorical_accuracy: 0.1779[1m41/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m0s[0m 18ms/step - loss: 2.2472 - sparse_categorical_accuracy: 0.1873[1m41/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 21ms/step - loss: 2.2431 - sparse_categorical_accuracy: 0.1903 - val_loss: 1.6360 - val_sparse_categorical_accuracy: 0.6636
Epoch 2/10
[1m 1/41[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 23ms/step - loss: 1.4402 - sparse_categorical_accuracy: 0.7812[1m 4/41[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 1.5063 - sparse_categorical_accuracy: 0.6419[1m 7/41[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 1.5135 - sparse_categorical_accuracy: 0.6030[1m10/41[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 1.5074 - sparse_categorical_accuracy: 0.5913[1m13/41[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 1.5013 - sparse_categorical_accuracy: 0.5817[1m16/41[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 1.4924 - sparse_categorical_accuracy: 0.5750[1m19/41[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 1.4797 - sparse_categorical_accuracy: 0.5762[1m22/41[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 1.4633 - sparse_categorical_accuracy: 0.5797[1m25/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 1.4480 - sparse_categorical_accuracy: 0.5823[1m28/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 1.4343 - sparse_categorical_accuracy: 0.5845[1m31/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 1.4213 - sparse_categorical_accuracy: 0.5870[1m34/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 18ms/step - loss: 1.4091 - sparse_categorical_accuracy: 0.5893[1m37/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 18ms/step - loss: 1.3966 - sparse_categorical_accuracy: 0.5918[1m40/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”[0m [1m0s[0m 18ms/step - loss: 1.3842 - sparse_categorical_accuracy: 0.5945[1m41/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 19ms/step - loss: 1.3763 - sparse_categorical_accuracy: 0.5961 - val_loss: 0.9386 - val_sparse_categorical_accuracy: 0.6820
Epoch 3/10
[1m 1/41[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 23ms/step - loss: 0.8177 - sparse_categorical_accuracy: 0.7188[1m 4/41[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.9616 - sparse_categorical_accuracy: 0.6452[1m 7/41[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.9653 - sparse_categorical_accuracy: 0.6633[1m10/41[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.9666 - sparse_categorical_accuracy: 0.6715[1m13/41[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.9649 - sparse_categorical_accuracy: 0.6766[1m16/41[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.9599 - sparse_categorical_accuracy: 0.6815[1m19/41[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.9516 - sparse_categorical_accuracy: 0.6872[1m22/41[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.9405 - sparse_categorical_accuracy: 0.6932[1m25/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.9305 - sparse_categorical_accuracy: 0.6976[1m28/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.9220 - sparse_categorical_accuracy: 0.7015[1m31/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.9137 - sparse_categorical_accuracy: 0.7048[1m34/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.9062 - sparse_categorical_accuracy: 0.7077[1m37/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 18ms/step - loss: 0.8984 - sparse_categorical_accuracy: 0.7106[1m40/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”[0m [1m0s[0m 18ms/step - loss: 0.8907 - sparse_categorical_accuracy: 0.7135[1m41/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 19ms/step - loss: 0.8859 - sparse_categorical_accuracy: 0.7153 - val_loss: 0.6795 - val_sparse_categorical_accuracy: 0.7492
Epoch 4/10
[1m 1/41[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 25ms/step - loss: 0.5344 - sparse_categorical_accuracy: 0.8438[1m 4/41[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.6800 - sparse_categorical_accuracy: 0.7897[1m 7/41[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.6911 - sparse_categorical_accuracy: 0.7943[1m10/41[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.6928 - sparse_categorical_accuracy: 0.7978[1m13/41[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.6918 - sparse_categorical_accuracy: 0.7972[1m16/41[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.6883 - sparse_categorical_accuracy: 0.7993[1m19/41[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.6818 - sparse_categorical_accuracy: 0.8023[1m22/41[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.6735 - sparse_categorical_accuracy: 0.8058[1m25/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.6663 - sparse_categorical_accuracy: 0.8088[1m28/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.6606 - sparse_categorical_accuracy: 0.8110[1m31/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.6553 - sparse_categorical_accuracy: 0.8125[1m34/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.6505 - sparse_categorical_accuracy: 0.8139[1m37/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 19ms/step - loss: 0.6454 - sparse_categorical_accuracy: 0.8154[1m40/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”[0m [1m0s[0m 19ms/step - loss: 0.6406 - sparse_categorical_accuracy: 0.8168[1m41/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 20ms/step - loss: 0.6376 - sparse_categorical_accuracy: 0.8177 - val_loss: 0.5152 - val_sparse_categorical_accuracy: 0.8838
Epoch 5/10
[1m 1/41[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 25ms/step - loss: 0.4261 - sparse_categorical_accuracy: 0.8438[1m 4/41[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.5282 - sparse_categorical_accuracy: 0.8223[1m 7/41[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.5395 - sparse_categorical_accuracy: 0.8211[1m10/41[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.5390 - sparse_categorical_accuracy: 0.8240[1m13/41[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.5366 - sparse_categorical_accuracy: 0.8271[1m16/41[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.5334 - sparse_categorical_accuracy: 0.8308[1m19/41[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.5280 - sparse_categorical_accuracy: 0.8348[1m22/41[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.5215 - sparse_categorical_accuracy: 0.8387[1m25/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.5160 - sparse_categorical_accuracy: 0.8419[1m28/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.5119 - sparse_categorical_accuracy: 0.8445[1m31/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.5080 - sparse_categorical_accuracy: 0.8463[1m34/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.5045 - sparse_categorical_accuracy: 0.8478[1m37/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 18ms/step - loss: 0.5008 - sparse_categorical_accuracy: 0.8493[1m40/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”[0m [1m0s[0m 18ms/step - loss: 0.4973 - sparse_categorical_accuracy: 0.8508[1m41/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 20ms/step - loss: 0.4951 - sparse_categorical_accuracy: 0.8517 - val_loss: 0.3982 - val_sparse_categorical_accuracy: 0.9174
Epoch 6/10
[1m 1/41[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 23ms/step - loss: 0.3051 - sparse_categorical_accuracy: 0.9375[1m 4/41[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 20ms/step - loss: 0.4089 - sparse_categorical_accuracy: 0.8926[1m 7/41[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.4295 - sparse_categorical_accuracy: 0.8725[1m10/41[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.4304 - sparse_categorical_accuracy: 0.8700[1m13/41[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.4298 - sparse_categorical_accuracy: 0.8698[1m16/41[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.4283 - sparse_categorical_accuracy: 0.8711[1m19/41[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.4247 - sparse_categorical_accuracy: 0.8741[1m22/41[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.4202 - sparse_categorical_accuracy: 0.8771[1m25/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.4162 - sparse_categorical_accuracy: 0.8799[1m28/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.4134 - sparse_categorical_accuracy: 0.8820[1m31/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.4105 - sparse_categorical_accuracy: 0.8841[1m34/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.4079 - sparse_categorical_accuracy: 0.8857[1m37/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 19ms/step - loss: 0.4051 - sparse_categorical_accuracy: 0.8873[1m40/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”[0m [1m0s[0m 19ms/step - loss: 0.4024 - sparse_categorical_accuracy: 0.8888[1m41/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 20ms/step - loss: 0.4008 - sparse_categorical_accuracy: 0.8897 - val_loss: 0.3429 - val_sparse_categorical_accuracy: 0.9266
Epoch 7/10
[1m 1/41[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 25ms/step - loss: 0.2725 - sparse_categorical_accuracy: 0.9375[1m 4/41[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.3596 - sparse_categorical_accuracy: 0.9121[1m 7/41[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.3706 - sparse_categorical_accuracy: 0.9062[1m10/41[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.3685 - sparse_categorical_accuracy: 0.9062[1m13/41[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.3647 - sparse_categorical_accuracy: 0.9068[1m16/41[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.3619 - sparse_categorical_accuracy: 0.9065[1m19/41[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.3576 - sparse_categorical_accuracy: 0.9071[1m22/41[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.3528 - sparse_categorical_accuracy: 0.9083[1m25/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.3486 - sparse_categorical_accuracy: 0.9096[1m28/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.3459 - sparse_categorical_accuracy: 0.9104[1m31/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.3430 - sparse_categorical_accuracy: 0.9114[1m34/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 20ms/step - loss: 0.3405 - sparse_categorical_accuracy: 0.9123[1m37/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 20ms/step - loss: 0.3379 - sparse_categorical_accuracy: 0.9132[1m40/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”[0m [1m0s[0m 20ms/step - loss: 0.3354 - sparse_categorical_accuracy: 0.9140[1m41/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 22ms/step - loss: 0.3339 - sparse_categorical_accuracy: 0.9146 - val_loss: 0.2768 - val_sparse_categorical_accuracy: 0.9419
Epoch 8/10
[1m 1/41[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 29ms/step - loss: 0.1760 - sparse_categorical_accuracy: 0.9375[1m 3/41[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 25ms/step - loss: 0.2819 - sparse_categorical_accuracy: 0.9236[1m 5/41[0m [32mâ”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 26ms/step - loss: 0.2938 - sparse_categorical_accuracy: 0.9226[1m 8/41[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 24ms/step - loss: 0.3020 - sparse_categorical_accuracy: 0.9231[1m11/41[0m [32mâ”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 23ms/step - loss: 0.3014 - sparse_categorical_accuracy: 0.9242[1m14/41[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 22ms/step - loss: 0.3004 - sparse_categorical_accuracy: 0.9246[1m17/41[0m [32mâ”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 22ms/step - loss: 0.2992 - sparse_categorical_accuracy: 0.9242[1m20/41[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 22ms/step - loss: 0.2962 - sparse_categorical_accuracy: 0.9245[1m23/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”[0m [1m0s[0m 22ms/step - loss: 0.2933 - sparse_categorical_accuracy: 0.9250[1m26/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 22ms/step - loss: 0.2911 - sparse_categorical_accuracy: 0.9255[1m29/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”[0m [1m0s[0m 22ms/step - loss: 0.2895 - sparse_categorical_accuracy: 0.9258[1m32/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”[0m [1m0s[0m 22ms/step - loss: 0.2877 - sparse_categorical_accuracy: 0.9262[1m35/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”[0m [1m0s[0m 22ms/step - loss: 0.2860 - sparse_categorical_accuracy: 0.9266[1m38/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 21ms/step - loss: 0.2842 - sparse_categorical_accuracy: 0.9270[1m41/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m0s[0m 21ms/step - loss: 0.2828 - sparse_categorical_accuracy: 0.9274[1m41/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 23ms/step - loss: 0.2824 - sparse_categorical_accuracy: 0.9275 - val_loss: 0.2389 - val_sparse_categorical_accuracy: 0.9511
Epoch 9/10
[1m 1/41[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 28ms/step - loss: 0.1192 - sparse_categorical_accuracy: 1.0000[1m 4/41[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.2257 - sparse_categorical_accuracy: 0.9661[1m 7/41[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.2488 - sparse_categorical_accuracy: 0.9553[1m10/41[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.2516 - sparse_categorical_accuracy: 0.9520[1m13/41[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.2513 - sparse_categorical_accuracy: 0.9497[1m16/41[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.2503 - sparse_categorical_accuracy: 0.9476[1m19/41[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.2488 - sparse_categorical_accuracy: 0.9456[1m22/41[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2468 - sparse_categorical_accuracy: 0.9447[1m25/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.2452 - sparse_categorical_accuracy: 0.9444[1m28/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.2441 - sparse_categorical_accuracy: 0.9439[1m31/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.2428 - sparse_categorical_accuracy: 0.9437[1m34/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.2416 - sparse_categorical_accuracy: 0.9436[1m37/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 19ms/step - loss: 0.2404 - sparse_categorical_accuracy: 0.9435[1m40/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”[0m [1m0s[0m 19ms/step - loss: 0.2394 - sparse_categorical_accuracy: 0.9433[1m41/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 20ms/step - loss: 0.2389 - sparse_categorical_accuracy: 0.9431 - val_loss: 0.2406 - val_sparse_categorical_accuracy: 0.9266
Epoch 10/10
[1m 1/41[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 26ms/step - loss: 0.0933 - sparse_categorical_accuracy: 1.0000[1m 4/41[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.2196 - sparse_categorical_accuracy: 0.9453[1m 7/41[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.2372 - sparse_categorical_accuracy: 0.9402[1m10/41[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.2419 - sparse_categorical_accuracy: 0.9383[1m13/41[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.2413 - sparse_categorical_accuracy: 0.9374[1m16/41[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.2405 - sparse_categorical_accuracy: 0.9369[1m19/41[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.2396 - sparse_categorical_accuracy: 0.9366[1m22/41[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.2378 - sparse_categorical_accuracy: 0.9369[1m25/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.2365 - sparse_categorical_accuracy: 0.9373[1m28/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.2352 - sparse_categorical_accuracy: 0.9377[1m31/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.2337 - sparse_categorical_accuracy: 0.9385[1m34/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.2324 - sparse_categorical_accuracy: 0.9390[1m37/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 19ms/step - loss: 0.2313 - sparse_categorical_accuracy: 0.9394[1m40/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”[0m [1m0s[0m 19ms/step - loss: 0.2305 - sparse_categorical_accuracy: 0.9396[1m41/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 20ms/step - loss: 0.2300 - sparse_categorical_accuracy: 0.9396 - val_loss: 0.2670 - val_sparse_categorical_accuracy: 0.9083
Saving the model using BentoML...
Exporting the model...

Model and training history saved at /Users/fabien/Library/CloudStorage/GoogleDrive-roth.fabien@gmail.com/My Drive/MSC_Datascience/02 - Courses/TSM-MachLeData/a-guide-to-mlops/model/baseline
Updating lock file 'dvc.lock'

Running stage 'ptq_dynamic_train':
> python3.11 a_guide_to_mlops/train/ptq/train_ptq_dynamic.py data/prepared model/ptq/dynamic
Script started...
Prepared Dataset Folder Path: /Users/fabien/Library/CloudStorage/GoogleDrive-roth.fabien@gmail.com/My Drive/MSC_Datascience/02 - Courses/TSM-MachLeData/a-guide-to-mlops/data/prepared
Model Folder Path: /Users/fabien/Library/CloudStorage/GoogleDrive-roth.fabien@gmail.com/My Drive/MSC_Datascience/02 - Courses/TSM-MachLeData/a-guide-to-mlops/model/ptq/dynamic
Loading datasets...
Datasets loaded successfully.
Loading labels from /Users/fabien/Library/CloudStorage/GoogleDrive-roth.fabien@gmail.com/My Drive/MSC_Datascience/02 - Courses/TSM-MachLeData/a-guide-to-mlops/data/prepared/labels.json
Defining model...
/Users/fabien/Library/CloudStorage/GoogleDrive-roth.fabien@gmail.com/My Drive/MSC_Datascience/02 - Courses/TSM-MachLeData/a-guide-to-mlops/.venv/lib/python3.11/site-packages/keras/src/layers/convolutional/base_conv.py:107: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
Model: "sequential"
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ Layer (type)                    â”ƒ Output Shape           â”ƒ       Param # â”ƒ
â”¡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”©
â”‚ conv2d (Conv2D)                 â”‚ (None, 30, 30, 64)     â”‚           640 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ max_pooling2d (MaxPooling2D)    â”‚ (None, 10, 10, 64)     â”‚             0 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ flatten (Flatten)               â”‚ (None, 6400)           â”‚             0 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ dense (Dense)                   â”‚ (None, 128)            â”‚       819,328 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ dense_1 (Dense)                 â”‚ (None, 11)             â”‚         1,419 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
 Total params: 821,387 (3.13 MB)
 Trainable params: 821,387 (3.13 MB)
 Non-trainable params: 0 (0.00 B)
Starting training...
Epoch 1/10
[1m 1/41[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m23s[0m 590ms/step - loss: 2.4014 - sparse_categorical_accuracy: 0.1250[1m 4/41[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 17ms/step - loss: 2.3643 - sparse_categorical_accuracy: 0.1400  [1m 7/41[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 17ms/step - loss: 2.3591 - sparse_categorical_accuracy: 0.1396[1m10/41[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 17ms/step - loss: 2.3544 - sparse_categorical_accuracy: 0.1332[1m13/41[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 17ms/step - loss: 2.3467 - sparse_categorical_accuracy: 0.1281[1m16/41[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 17ms/step - loss: 2.3367 - sparse_categorical_accuracy: 0.1283[1m19/41[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 17ms/step - loss: 2.3272 - sparse_categorical_accuracy: 0.1319[1m22/41[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 17ms/step - loss: 2.3169 - sparse_categorical_accuracy: 0.1378[1m25/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 2.3070 - sparse_categorical_accuracy: 0.1433[1m28/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 2.2976 - sparse_categorical_accuracy: 0.1495[1m31/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”[0m [1m0s[0m 17ms/step - loss: 2.2872 - sparse_categorical_accuracy: 0.1575[1m34/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 17ms/step - loss: 2.2760 - sparse_categorical_accuracy: 0.1660[1m37/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 17ms/step - loss: 2.2640 - sparse_categorical_accuracy: 0.1748[1m40/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”[0m [1m0s[0m 17ms/step - loss: 2.2514 - sparse_categorical_accuracy: 0.1842[1m41/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 21ms/step - loss: 2.2431 - sparse_categorical_accuracy: 0.1903 - val_loss: 1.6360 - val_sparse_categorical_accuracy: 0.6636
Epoch 2/10
[1m 1/41[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 23ms/step - loss: 1.4402 - sparse_categorical_accuracy: 0.7812[1m 4/41[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 1.5063 - sparse_categorical_accuracy: 0.6419[1m 7/41[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 1.5135 - sparse_categorical_accuracy: 0.6030[1m10/41[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 1.5074 - sparse_categorical_accuracy: 0.5913[1m13/41[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 1.5013 - sparse_categorical_accuracy: 0.5817[1m16/41[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 1.4924 - sparse_categorical_accuracy: 0.5750[1m19/41[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 1.4797 - sparse_categorical_accuracy: 0.5762[1m22/41[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 1.4633 - sparse_categorical_accuracy: 0.5797[1m25/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 1.4480 - sparse_categorical_accuracy: 0.5823[1m28/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 1.4343 - sparse_categorical_accuracy: 0.5845[1m31/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 1.4213 - sparse_categorical_accuracy: 0.5870[1m34/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 18ms/step - loss: 1.4091 - sparse_categorical_accuracy: 0.5893[1m37/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 18ms/step - loss: 1.3966 - sparse_categorical_accuracy: 0.5918[1m40/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”[0m [1m0s[0m 18ms/step - loss: 1.3842 - sparse_categorical_accuracy: 0.5945[1m41/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 19ms/step - loss: 1.3763 - sparse_categorical_accuracy: 0.5961 - val_loss: 0.9386 - val_sparse_categorical_accuracy: 0.6820
Epoch 3/10
[1m 1/41[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 22ms/step - loss: 0.8177 - sparse_categorical_accuracy: 0.7188[1m 4/41[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.9616 - sparse_categorical_accuracy: 0.6452[1m 7/41[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.9653 - sparse_categorical_accuracy: 0.6633[1m10/41[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.9666 - sparse_categorical_accuracy: 0.6715[1m13/41[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.9649 - sparse_categorical_accuracy: 0.6766[1m16/41[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.9599 - sparse_categorical_accuracy: 0.6815[1m19/41[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.9516 - sparse_categorical_accuracy: 0.6872[1m22/41[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.9405 - sparse_categorical_accuracy: 0.6932[1m25/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.9305 - sparse_categorical_accuracy: 0.6976[1m28/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.9220 - sparse_categorical_accuracy: 0.7015[1m31/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.9137 - sparse_categorical_accuracy: 0.7048[1m34/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.9062 - sparse_categorical_accuracy: 0.7077[1m37/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 18ms/step - loss: 0.8984 - sparse_categorical_accuracy: 0.7106[1m40/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”[0m [1m0s[0m 18ms/step - loss: 0.8907 - sparse_categorical_accuracy: 0.7135[1m41/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 19ms/step - loss: 0.8859 - sparse_categorical_accuracy: 0.7153 - val_loss: 0.6795 - val_sparse_categorical_accuracy: 0.7492
Epoch 4/10
[1m 1/41[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 24ms/step - loss: 0.5344 - sparse_categorical_accuracy: 0.8438[1m 4/41[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.6800 - sparse_categorical_accuracy: 0.7897[1m 7/41[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.6911 - sparse_categorical_accuracy: 0.7943[1m10/41[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.6928 - sparse_categorical_accuracy: 0.7978[1m13/41[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.6918 - sparse_categorical_accuracy: 0.7972[1m16/41[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.6883 - sparse_categorical_accuracy: 0.7993[1m19/41[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.6818 - sparse_categorical_accuracy: 0.8023[1m22/41[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.6735 - sparse_categorical_accuracy: 0.8058[1m25/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.6663 - sparse_categorical_accuracy: 0.8088[1m28/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 17ms/step - loss: 0.6606 - sparse_categorical_accuracy: 0.8110[1m31/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.6553 - sparse_categorical_accuracy: 0.8125[1m34/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 17ms/step - loss: 0.6505 - sparse_categorical_accuracy: 0.8139[1m37/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 18ms/step - loss: 0.6454 - sparse_categorical_accuracy: 0.8154[1m40/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”[0m [1m0s[0m 18ms/step - loss: 0.6406 - sparse_categorical_accuracy: 0.8168[1m41/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 19ms/step - loss: 0.6376 - sparse_categorical_accuracy: 0.8177 - val_loss: 0.5152 - val_sparse_categorical_accuracy: 0.8838
Epoch 5/10
[1m 1/41[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 23ms/step - loss: 0.4261 - sparse_categorical_accuracy: 0.8438[1m 4/41[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 17ms/step - loss: 0.5282 - sparse_categorical_accuracy: 0.8223[1m 7/41[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 17ms/step - loss: 0.5395 - sparse_categorical_accuracy: 0.8211[1m10/41[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 17ms/step - loss: 0.5390 - sparse_categorical_accuracy: 0.8240[1m13/41[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 17ms/step - loss: 0.5366 - sparse_categorical_accuracy: 0.8271[1m16/41[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.5334 - sparse_categorical_accuracy: 0.8308[1m20/41[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 17ms/step - loss: 0.5257 - sparse_categorical_accuracy: 0.8362[1m23/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”[0m [1m0s[0m 17ms/step - loss: 0.5192 - sparse_categorical_accuracy: 0.8400[1m26/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 17ms/step - loss: 0.5146 - sparse_categorical_accuracy: 0.8428[1m29/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”[0m [1m0s[0m 17ms/step - loss: 0.5105 - sparse_categorical_accuracy: 0.8452[1m32/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”[0m [1m0s[0m 17ms/step - loss: 0.5069 - sparse_categorical_accuracy: 0.8468[1m35/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”[0m [1m0s[0m 17ms/step - loss: 0.5033 - sparse_categorical_accuracy: 0.8483[1m38/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 17ms/step - loss: 0.4996 - sparse_categorical_accuracy: 0.8498[1m41/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m0s[0m 17ms/step - loss: 0.4962 - sparse_categorical_accuracy: 0.8513[1m41/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 19ms/step - loss: 0.4951 - sparse_categorical_accuracy: 0.8517 - val_loss: 0.3982 - val_sparse_categorical_accuracy: 0.9174
Epoch 6/10
[1m 1/41[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 23ms/step - loss: 0.3051 - sparse_categorical_accuracy: 0.9375[1m 4/41[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.4089 - sparse_categorical_accuracy: 0.8926[1m 7/41[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.4295 - sparse_categorical_accuracy: 0.8725[1m10/41[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.4304 - sparse_categorical_accuracy: 0.8700[1m13/41[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.4298 - sparse_categorical_accuracy: 0.8698[1m16/41[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.4283 - sparse_categorical_accuracy: 0.8711[1m19/41[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.4247 - sparse_categorical_accuracy: 0.8741[1m22/41[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.4202 - sparse_categorical_accuracy: 0.8771[1m25/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.4162 - sparse_categorical_accuracy: 0.8799[1m28/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.4134 - sparse_categorical_accuracy: 0.8820[1m31/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.4105 - sparse_categorical_accuracy: 0.8841[1m34/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.4079 - sparse_categorical_accuracy: 0.8857[1m37/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 18ms/step - loss: 0.4051 - sparse_categorical_accuracy: 0.8873[1m40/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”[0m [1m0s[0m 18ms/step - loss: 0.4024 - sparse_categorical_accuracy: 0.8888[1m41/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 19ms/step - loss: 0.4008 - sparse_categorical_accuracy: 0.8897 - val_loss: 0.3429 - val_sparse_categorical_accuracy: 0.9266
Epoch 7/10
[1m 1/41[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 24ms/step - loss: 0.2725 - sparse_categorical_accuracy: 0.9375[1m 4/41[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.3596 - sparse_categorical_accuracy: 0.9121[1m 7/41[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.3706 - sparse_categorical_accuracy: 0.9062[1m10/41[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.3685 - sparse_categorical_accuracy: 0.9062[1m13/41[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.3647 - sparse_categorical_accuracy: 0.9068[1m16/41[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.3619 - sparse_categorical_accuracy: 0.9065[1m19/41[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.3576 - sparse_categorical_accuracy: 0.9071[1m22/41[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.3528 - sparse_categorical_accuracy: 0.9083[1m25/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.3486 - sparse_categorical_accuracy: 0.9096[1m28/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.3459 - sparse_categorical_accuracy: 0.9104[1m31/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.3430 - sparse_categorical_accuracy: 0.9114[1m34/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.3405 - sparse_categorical_accuracy: 0.9123[1m37/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 18ms/step - loss: 0.3379 - sparse_categorical_accuracy: 0.9132[1m40/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”[0m [1m0s[0m 18ms/step - loss: 0.3354 - sparse_categorical_accuracy: 0.9140[1m41/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 20ms/step - loss: 0.3339 - sparse_categorical_accuracy: 0.9146 - val_loss: 0.2768 - val_sparse_categorical_accuracy: 0.9419
Epoch 8/10
[1m 1/41[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 24ms/step - loss: 0.1760 - sparse_categorical_accuracy: 0.9375[1m 4/41[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2817 - sparse_categorical_accuracy: 0.9251[1m 7/41[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.3012 - sparse_categorical_accuracy: 0.9227[1m10/41[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.3019 - sparse_categorical_accuracy: 0.9237[1m13/41[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.3012 - sparse_categorical_accuracy: 0.9243[1m16/41[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2999 - sparse_categorical_accuracy: 0.9243[1m19/41[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2974 - sparse_categorical_accuracy: 0.9243[1m22/41[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2943 - sparse_categorical_accuracy: 0.9247[1m25/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2917 - sparse_categorical_accuracy: 0.9254[1m28/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.2901 - sparse_categorical_accuracy: 0.9257[1m31/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2883 - sparse_categorical_accuracy: 0.9261[1m34/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2866 - sparse_categorical_accuracy: 0.9265[1m37/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 18ms/step - loss: 0.2848 - sparse_categorical_accuracy: 0.9269[1m40/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”[0m [1m0s[0m 18ms/step - loss: 0.2833 - sparse_categorical_accuracy: 0.9272[1m41/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 20ms/step - loss: 0.2824 - sparse_categorical_accuracy: 0.9275 - val_loss: 0.2389 - val_sparse_categorical_accuracy: 0.9511
Epoch 9/10
[1m 1/41[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 26ms/step - loss: 0.1192 - sparse_categorical_accuracy: 1.0000[1m 4/41[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2257 - sparse_categorical_accuracy: 0.9661[1m 7/41[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2488 - sparse_categorical_accuracy: 0.9553[1m10/41[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2516 - sparse_categorical_accuracy: 0.9520[1m13/41[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2513 - sparse_categorical_accuracy: 0.9497[1m16/41[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2503 - sparse_categorical_accuracy: 0.9476[1m19/41[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2488 - sparse_categorical_accuracy: 0.9456[1m22/41[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2468 - sparse_categorical_accuracy: 0.9447[1m25/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2452 - sparse_categorical_accuracy: 0.9444[1m28/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2441 - sparse_categorical_accuracy: 0.9439[1m31/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2428 - sparse_categorical_accuracy: 0.9437[1m34/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2416 - sparse_categorical_accuracy: 0.9436[1m37/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 18ms/step - loss: 0.2404 - sparse_categorical_accuracy: 0.9435[1m40/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”[0m [1m0s[0m 18ms/step - loss: 0.2394 - sparse_categorical_accuracy: 0.9433[1m41/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 20ms/step - loss: 0.2389 - sparse_categorical_accuracy: 0.9431 - val_loss: 0.2406 - val_sparse_categorical_accuracy: 0.9266
Epoch 10/10
[1m 1/41[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 27ms/step - loss: 0.0933 - sparse_categorical_accuracy: 1.0000[1m 4/41[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2196 - sparse_categorical_accuracy: 0.9453[1m 7/41[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2372 - sparse_categorical_accuracy: 0.9402[1m10/41[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2419 - sparse_categorical_accuracy: 0.9383[1m13/41[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2413 - sparse_categorical_accuracy: 0.9374[1m16/41[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2405 - sparse_categorical_accuracy: 0.9369[1m19/41[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2396 - sparse_categorical_accuracy: 0.9366[1m22/41[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2378 - sparse_categorical_accuracy: 0.9369[1m25/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2365 - sparse_categorical_accuracy: 0.9373[1m28/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2352 - sparse_categorical_accuracy: 0.9377[1m31/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2337 - sparse_categorical_accuracy: 0.9385[1m34/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2324 - sparse_categorical_accuracy: 0.9390[1m37/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 18ms/step - loss: 0.2313 - sparse_categorical_accuracy: 0.9394[1m40/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”[0m [1m0s[0m 18ms/step - loss: 0.2305 - sparse_categorical_accuracy: 0.9396[1m41/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 20ms/step - loss: 0.2300 - sparse_categorical_accuracy: 0.9396 - val_loss: 0.2670 - val_sparse_categorical_accuracy: 0.9083
Applying Dynamic Range Quantization...
Saved artifact at '/var/folders/0y/czyrd9qx7yb0z904_86qw5z00000gn/T/tmpgjqijgew'. The following endpoints are available:

* Endpoint 'serve'
  args_0 (POSITIONAL_ONLY): TensorSpec(shape=(None, 32, 32, 1), dtype=tf.float32, name='keras_tensor')
Output Type:
  TensorSpec(shape=(None, 11), dtype=tf.float32, name=None)
Captures:
  12979319056: TensorSpec(shape=(), dtype=tf.resource, name=None)
  12979320784: TensorSpec(shape=(), dtype=tf.resource, name=None)
  12979320976: TensorSpec(shape=(), dtype=tf.resource, name=None)
  12979320400: TensorSpec(shape=(), dtype=tf.resource, name=None)
  12979321936: TensorSpec(shape=(), dtype=tf.resource, name=None)
  12979321552: TensorSpec(shape=(), dtype=tf.resource, name=None)
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
W0000 00:00:1731532382.069166  868754 tf_tfl_flatbuffer_helpers.cc:365] Ignored output_format.
W0000 00:00:1731532382.069185  868754 tf_tfl_flatbuffer_helpers.cc:368] Ignored drop_control_dependency.
2024-11-13 22:13:02.069602: I tensorflow/cc/saved_model/reader.cc:83] Reading SavedModel from: /var/folders/0y/czyrd9qx7yb0z904_86qw5z00000gn/T/tmpgjqijgew
2024-11-13 22:13:02.069882: I tensorflow/cc/saved_model/reader.cc:52] Reading meta graph with tags { serve }
2024-11-13 22:13:02.069888: I tensorflow/cc/saved_model/reader.cc:147] Reading SavedModel debug info (if present) from: /var/folders/0y/czyrd9qx7yb0z904_86qw5z00000gn/T/tmpgjqijgew
I0000 00:00:1731532382.071719  868754 mlir_graph_optimization_pass.cc:401] MLIR V1 optimization pass is not enabled
2024-11-13 22:13:02.072067: I tensorflow/cc/saved_model/loader.cc:236] Restoring SavedModel bundle.
2024-11-13 22:13:02.088431: I tensorflow/cc/saved_model/loader.cc:220] Running initialization op on SavedModel bundle at path: /var/folders/0y/czyrd9qx7yb0z904_86qw5z00000gn/T/tmpgjqijgew
2024-11-13 22:13:02.092895: I tensorflow/cc/saved_model/loader.cc:466] SavedModel load for tags { serve }; Status: success: OK. Took 23296 microseconds.
2024-11-13 22:13:02.119232: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:268] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
Saving the model using BentoML...
Exporting the model...

Model, TFLite model, and training history saved at /Users/fabien/Library/CloudStorage/GoogleDrive-roth.fabien@gmail.com/My Drive/MSC_Datascience/02 - Courses/TSM-MachLeData/a-guide-to-mlops/model/ptq/dynamic
Updating lock file 'dvc.lock'

Running stage 'ptq_float16_train':
> python3.11 a_guide_to_mlops/train/ptq/train_ptq_float16.py data/prepared model/ptq/float16
Script started...
Prepared Dataset Folder Path: /Users/fabien/Library/CloudStorage/GoogleDrive-roth.fabien@gmail.com/My Drive/MSC_Datascience/02 - Courses/TSM-MachLeData/a-guide-to-mlops/data/prepared
Model Folder Path: /Users/fabien/Library/CloudStorage/GoogleDrive-roth.fabien@gmail.com/My Drive/MSC_Datascience/02 - Courses/TSM-MachLeData/a-guide-to-mlops/model/ptq/float16
Loading datasets...
Datasets loaded successfully.
Loading labels from /Users/fabien/Library/CloudStorage/GoogleDrive-roth.fabien@gmail.com/My Drive/MSC_Datascience/02 - Courses/TSM-MachLeData/a-guide-to-mlops/data/prepared/labels.json
Defining model...
/Users/fabien/Library/CloudStorage/GoogleDrive-roth.fabien@gmail.com/My Drive/MSC_Datascience/02 - Courses/TSM-MachLeData/a-guide-to-mlops/.venv/lib/python3.11/site-packages/keras/src/layers/convolutional/base_conv.py:107: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
Model: "sequential"
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ Layer (type)                    â”ƒ Output Shape           â”ƒ       Param # â”ƒ
â”¡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”©
â”‚ conv2d (Conv2D)                 â”‚ (None, 30, 30, 64)     â”‚           640 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ max_pooling2d (MaxPooling2D)    â”‚ (None, 10, 10, 64)     â”‚             0 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ flatten (Flatten)               â”‚ (None, 6400)           â”‚             0 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ dense (Dense)                   â”‚ (None, 128)            â”‚       819,328 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ dense_1 (Dense)                 â”‚ (None, 11)             â”‚         1,419 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
 Total params: 821,387 (3.13 MB)
 Trainable params: 821,387 (3.13 MB)
 Non-trainable params: 0 (0.00 B)
Starting training...
Epoch 1/10
[1m 1/41[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m25s[0m 646ms/step - loss: 2.4014 - sparse_categorical_accuracy: 0.1250[1m 4/41[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 2.3643 - sparse_categorical_accuracy: 0.1400  [1m 7/41[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 2.3591 - sparse_categorical_accuracy: 0.1396[1m10/41[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 2.3544 - sparse_categorical_accuracy: 0.1332[1m13/41[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 2.3467 - sparse_categorical_accuracy: 0.1281[1m16/41[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 2.3367 - sparse_categorical_accuracy: 0.1283[1m19/41[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 2.3272 - sparse_categorical_accuracy: 0.1319[1m22/41[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 2.3169 - sparse_categorical_accuracy: 0.1378[1m25/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 2.3070 - sparse_categorical_accuracy: 0.1433[1m28/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 2.2976 - sparse_categorical_accuracy: 0.1495[1m31/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 2.2872 - sparse_categorical_accuracy: 0.1575[1m34/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 18ms/step - loss: 2.2760 - sparse_categorical_accuracy: 0.1660[1m37/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 18ms/step - loss: 2.2640 - sparse_categorical_accuracy: 0.1748[1m40/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”[0m [1m0s[0m 18ms/step - loss: 2.2514 - sparse_categorical_accuracy: 0.1842[1m41/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 21ms/step - loss: 2.2431 - sparse_categorical_accuracy: 0.1903 - val_loss: 1.6360 - val_sparse_categorical_accuracy: 0.6636
Epoch 2/10
[1m 1/41[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 24ms/step - loss: 1.4402 - sparse_categorical_accuracy: 0.7812[1m 4/41[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 1.5063 - sparse_categorical_accuracy: 0.6419[1m 7/41[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 1.5135 - sparse_categorical_accuracy: 0.6030[1m10/41[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 1.5074 - sparse_categorical_accuracy: 0.5913[1m13/41[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 1.5013 - sparse_categorical_accuracy: 0.5817[1m16/41[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 1.4924 - sparse_categorical_accuracy: 0.5750[1m19/41[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 1.4797 - sparse_categorical_accuracy: 0.5762[1m22/41[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 1.4633 - sparse_categorical_accuracy: 0.5797[1m25/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 1.4480 - sparse_categorical_accuracy: 0.5823[1m28/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 1.4343 - sparse_categorical_accuracy: 0.5845[1m31/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 1.4213 - sparse_categorical_accuracy: 0.5870[1m34/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 18ms/step - loss: 1.4091 - sparse_categorical_accuracy: 0.5893[1m37/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 18ms/step - loss: 1.3966 - sparse_categorical_accuracy: 0.5918[1m40/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”[0m [1m0s[0m 18ms/step - loss: 1.3842 - sparse_categorical_accuracy: 0.5945[1m41/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 20ms/step - loss: 1.3763 - sparse_categorical_accuracy: 0.5961 - val_loss: 0.9386 - val_sparse_categorical_accuracy: 0.6820
Epoch 3/10
[1m 1/41[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 23ms/step - loss: 0.8177 - sparse_categorical_accuracy: 0.7188[1m 4/41[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.9616 - sparse_categorical_accuracy: 0.6452[1m 7/41[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.9653 - sparse_categorical_accuracy: 0.6633[1m10/41[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.9666 - sparse_categorical_accuracy: 0.6715[1m13/41[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.9649 - sparse_categorical_accuracy: 0.6766[1m16/41[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.9599 - sparse_categorical_accuracy: 0.6815[1m19/41[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.9516 - sparse_categorical_accuracy: 0.6872[1m22/41[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.9405 - sparse_categorical_accuracy: 0.6932[1m25/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.9305 - sparse_categorical_accuracy: 0.6976[1m28/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.9220 - sparse_categorical_accuracy: 0.7015[1m31/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.9137 - sparse_categorical_accuracy: 0.7048[1m34/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.9062 - sparse_categorical_accuracy: 0.7077[1m37/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 18ms/step - loss: 0.8984 - sparse_categorical_accuracy: 0.7106[1m40/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”[0m [1m0s[0m 18ms/step - loss: 0.8907 - sparse_categorical_accuracy: 0.7135[1m41/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 20ms/step - loss: 0.8859 - sparse_categorical_accuracy: 0.7153 - val_loss: 0.6795 - val_sparse_categorical_accuracy: 0.7492
Epoch 4/10
[1m 1/41[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 24ms/step - loss: 0.5344 - sparse_categorical_accuracy: 0.8438[1m 4/41[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.6800 - sparse_categorical_accuracy: 0.7897[1m 7/41[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 25ms/step - loss: 0.6911 - sparse_categorical_accuracy: 0.7943[1m10/41[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 24ms/step - loss: 0.6928 - sparse_categorical_accuracy: 0.7978[1m13/41[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 22ms/step - loss: 0.6918 - sparse_categorical_accuracy: 0.7972[1m16/41[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 22ms/step - loss: 0.6883 - sparse_categorical_accuracy: 0.7993[1m19/41[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 21ms/step - loss: 0.6818 - sparse_categorical_accuracy: 0.8023[1m22/41[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 21ms/step - loss: 0.6735 - sparse_categorical_accuracy: 0.8058[1m25/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 20ms/step - loss: 0.6663 - sparse_categorical_accuracy: 0.8088[1m28/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 20ms/step - loss: 0.6606 - sparse_categorical_accuracy: 0.8110[1m31/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”[0m [1m0s[0m 20ms/step - loss: 0.6553 - sparse_categorical_accuracy: 0.8125[1m34/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 20ms/step - loss: 0.6505 - sparse_categorical_accuracy: 0.8139[1m37/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 20ms/step - loss: 0.6454 - sparse_categorical_accuracy: 0.8154[1m40/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”[0m [1m0s[0m 19ms/step - loss: 0.6406 - sparse_categorical_accuracy: 0.8168[1m41/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 21ms/step - loss: 0.6376 - sparse_categorical_accuracy: 0.8177 - val_loss: 0.5152 - val_sparse_categorical_accuracy: 0.8838
Epoch 5/10
[1m 1/41[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 24ms/step - loss: 0.4261 - sparse_categorical_accuracy: 0.8438[1m 4/41[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.5282 - sparse_categorical_accuracy: 0.8223[1m 7/41[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.5395 - sparse_categorical_accuracy: 0.8211[1m10/41[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.5390 - sparse_categorical_accuracy: 0.8240[1m13/41[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.5366 - sparse_categorical_accuracy: 0.8271[1m16/41[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.5334 - sparse_categorical_accuracy: 0.8308[1m19/41[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.5280 - sparse_categorical_accuracy: 0.8348[1m22/41[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.5215 - sparse_categorical_accuracy: 0.8387[1m25/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.5160 - sparse_categorical_accuracy: 0.8419[1m28/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.5119 - sparse_categorical_accuracy: 0.8445[1m31/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.5080 - sparse_categorical_accuracy: 0.8463[1m34/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.5045 - sparse_categorical_accuracy: 0.8478[1m37/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 18ms/step - loss: 0.5008 - sparse_categorical_accuracy: 0.8493[1m40/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”[0m [1m0s[0m 18ms/step - loss: 0.4973 - sparse_categorical_accuracy: 0.8508[1m41/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 20ms/step - loss: 0.4951 - sparse_categorical_accuracy: 0.8517 - val_loss: 0.3982 - val_sparse_categorical_accuracy: 0.9174
Epoch 6/10
[1m 1/41[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 23ms/step - loss: 0.3051 - sparse_categorical_accuracy: 0.9375[1m 4/41[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.4089 - sparse_categorical_accuracy: 0.8926[1m 7/41[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.4295 - sparse_categorical_accuracy: 0.8725[1m10/41[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.4304 - sparse_categorical_accuracy: 0.8700[1m13/41[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.4298 - sparse_categorical_accuracy: 0.8698[1m16/41[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.4283 - sparse_categorical_accuracy: 0.8711[1m19/41[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.4247 - sparse_categorical_accuracy: 0.8741[1m22/41[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.4202 - sparse_categorical_accuracy: 0.8771[1m25/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.4162 - sparse_categorical_accuracy: 0.8799[1m28/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.4134 - sparse_categorical_accuracy: 0.8820[1m31/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.4105 - sparse_categorical_accuracy: 0.8841[1m34/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.4079 - sparse_categorical_accuracy: 0.8857[1m37/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 18ms/step - loss: 0.4051 - sparse_categorical_accuracy: 0.8873[1m40/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”[0m [1m0s[0m 18ms/step - loss: 0.4024 - sparse_categorical_accuracy: 0.8888[1m41/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 20ms/step - loss: 0.4008 - sparse_categorical_accuracy: 0.8897 - val_loss: 0.3429 - val_sparse_categorical_accuracy: 0.9266
Epoch 7/10
[1m 1/41[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 24ms/step - loss: 0.2725 - sparse_categorical_accuracy: 0.9375[1m 4/41[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.3596 - sparse_categorical_accuracy: 0.9121[1m 7/41[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.3706 - sparse_categorical_accuracy: 0.9062[1m10/41[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.3685 - sparse_categorical_accuracy: 0.9062[1m13/41[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.3647 - sparse_categorical_accuracy: 0.9068[1m16/41[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.3619 - sparse_categorical_accuracy: 0.9065[1m19/41[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.3576 - sparse_categorical_accuracy: 0.9071[1m22/41[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.3528 - sparse_categorical_accuracy: 0.9083[1m25/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.3486 - sparse_categorical_accuracy: 0.9096[1m28/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.3459 - sparse_categorical_accuracy: 0.9104[1m31/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.3430 - sparse_categorical_accuracy: 0.9114[1m34/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.3405 - sparse_categorical_accuracy: 0.9123[1m37/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 18ms/step - loss: 0.3379 - sparse_categorical_accuracy: 0.9132[1m40/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”[0m [1m0s[0m 18ms/step - loss: 0.3354 - sparse_categorical_accuracy: 0.9140[1m41/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 20ms/step - loss: 0.3339 - sparse_categorical_accuracy: 0.9146 - val_loss: 0.2768 - val_sparse_categorical_accuracy: 0.9419
Epoch 8/10
[1m 1/41[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 24ms/step - loss: 0.1760 - sparse_categorical_accuracy: 0.9375[1m 4/41[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.2817 - sparse_categorical_accuracy: 0.9251[1m 7/41[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.3012 - sparse_categorical_accuracy: 0.9227[1m10/41[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.3019 - sparse_categorical_accuracy: 0.9237[1m13/41[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.3012 - sparse_categorical_accuracy: 0.9243[1m16/41[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2999 - sparse_categorical_accuracy: 0.9243[1m19/41[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2974 - sparse_categorical_accuracy: 0.9243[1m22/41[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2943 - sparse_categorical_accuracy: 0.9247[1m25/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2917 - sparse_categorical_accuracy: 0.9254[1m28/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2901 - sparse_categorical_accuracy: 0.9257[1m31/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2883 - sparse_categorical_accuracy: 0.9261[1m34/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2866 - sparse_categorical_accuracy: 0.9265[1m37/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 18ms/step - loss: 0.2848 - sparse_categorical_accuracy: 0.9269[1m40/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”[0m [1m0s[0m 18ms/step - loss: 0.2833 - sparse_categorical_accuracy: 0.9272[1m41/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 20ms/step - loss: 0.2824 - sparse_categorical_accuracy: 0.9275 - val_loss: 0.2389 - val_sparse_categorical_accuracy: 0.9511
Epoch 9/10
[1m 1/41[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 26ms/step - loss: 0.1192 - sparse_categorical_accuracy: 1.0000[1m 4/41[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2257 - sparse_categorical_accuracy: 0.9661[1m 7/41[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2488 - sparse_categorical_accuracy: 0.9553[1m10/41[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2516 - sparse_categorical_accuracy: 0.9520[1m13/41[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2513 - sparse_categorical_accuracy: 0.9497[1m16/41[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2503 - sparse_categorical_accuracy: 0.9476[1m19/41[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2488 - sparse_categorical_accuracy: 0.9456[1m22/41[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2468 - sparse_categorical_accuracy: 0.9447[1m25/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2452 - sparse_categorical_accuracy: 0.9444[1m28/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2441 - sparse_categorical_accuracy: 0.9439[1m31/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2428 - sparse_categorical_accuracy: 0.9437[1m34/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2416 - sparse_categorical_accuracy: 0.9436[1m37/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 18ms/step - loss: 0.2404 - sparse_categorical_accuracy: 0.9435[1m40/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”[0m [1m0s[0m 18ms/step - loss: 0.2394 - sparse_categorical_accuracy: 0.9433[1m41/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 20ms/step - loss: 0.2389 - sparse_categorical_accuracy: 0.9431 - val_loss: 0.2406 - val_sparse_categorical_accuracy: 0.9266
Epoch 10/10
[1m 1/41[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 25ms/step - loss: 0.0933 - sparse_categorical_accuracy: 1.0000[1m 4/41[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2196 - sparse_categorical_accuracy: 0.9453[1m 7/41[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2372 - sparse_categorical_accuracy: 0.9402[1m10/41[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2419 - sparse_categorical_accuracy: 0.9383[1m13/41[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2413 - sparse_categorical_accuracy: 0.9374[1m16/41[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2405 - sparse_categorical_accuracy: 0.9369[1m19/41[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2396 - sparse_categorical_accuracy: 0.9366[1m22/41[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2378 - sparse_categorical_accuracy: 0.9369[1m25/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2365 - sparse_categorical_accuracy: 0.9373[1m28/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2352 - sparse_categorical_accuracy: 0.9377[1m31/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2337 - sparse_categorical_accuracy: 0.9385[1m34/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2324 - sparse_categorical_accuracy: 0.9390[1m37/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 18ms/step - loss: 0.2313 - sparse_categorical_accuracy: 0.9394[1m40/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”[0m [1m0s[0m 18ms/step - loss: 0.2305 - sparse_categorical_accuracy: 0.9396[1m41/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 20ms/step - loss: 0.2300 - sparse_categorical_accuracy: 0.9396 - val_loss: 0.2670 - val_sparse_categorical_accuracy: 0.9083
Applying Float16 Quantization...
Saved artifact at '/var/folders/0y/czyrd9qx7yb0z904_86qw5z00000gn/T/tmpx7rky_a0'. The following endpoints are available:

* Endpoint 'serve'
  args_0 (POSITIONAL_ONLY): TensorSpec(shape=(None, 32, 32, 1), dtype=tf.float32, name='keras_tensor')
Output Type:
  TensorSpec(shape=(None, 11), dtype=tf.float32, name=None)
Captures:
  13045362960: TensorSpec(shape=(), dtype=tf.resource, name=None)
  13045364688: TensorSpec(shape=(), dtype=tf.resource, name=None)
  13045364880: TensorSpec(shape=(), dtype=tf.resource, name=None)
  13045364304: TensorSpec(shape=(), dtype=tf.resource, name=None)
  13045365840: TensorSpec(shape=(), dtype=tf.resource, name=None)
  13045365456: TensorSpec(shape=(), dtype=tf.resource, name=None)
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
W0000 00:00:1731532400.430254  870568 tf_tfl_flatbuffer_helpers.cc:365] Ignored output_format.
W0000 00:00:1731532400.430276  870568 tf_tfl_flatbuffer_helpers.cc:368] Ignored drop_control_dependency.
2024-11-13 22:13:20.430531: I tensorflow/cc/saved_model/reader.cc:83] Reading SavedModel from: /var/folders/0y/czyrd9qx7yb0z904_86qw5z00000gn/T/tmpx7rky_a0
2024-11-13 22:13:20.430818: I tensorflow/cc/saved_model/reader.cc:52] Reading meta graph with tags { serve }
2024-11-13 22:13:20.430825: I tensorflow/cc/saved_model/reader.cc:147] Reading SavedModel debug info (if present) from: /var/folders/0y/czyrd9qx7yb0z904_86qw5z00000gn/T/tmpx7rky_a0
I0000 00:00:1731532400.432786  870568 mlir_graph_optimization_pass.cc:401] MLIR V1 optimization pass is not enabled
2024-11-13 22:13:20.433194: I tensorflow/cc/saved_model/loader.cc:236] Restoring SavedModel bundle.
2024-11-13 22:13:20.449477: I tensorflow/cc/saved_model/loader.cc:220] Running initialization op on SavedModel bundle at path: /var/folders/0y/czyrd9qx7yb0z904_86qw5z00000gn/T/tmpx7rky_a0
2024-11-13 22:13:20.453754: I tensorflow/cc/saved_model/loader.cc:466] SavedModel load for tags { serve }; Status: success: OK. Took 23227 microseconds.
2024-11-13 22:13:20.458504: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:268] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
Saving the model using BentoML...
Exporting the model...

Model, TFLite model, and training history saved at /Users/fabien/Library/CloudStorage/GoogleDrive-roth.fabien@gmail.com/My Drive/MSC_Datascience/02 - Courses/TSM-MachLeData/a-guide-to-mlops/model/ptq/float16
Updating lock file 'dvc.lock'

Running stage 'ptq_integer_train':
> python3.11 a_guide_to_mlops/train/ptq/train_ptq_integer.py data/prepared model/ptq/integer
Script started...
Command Line Arguments: ['a_guide_to_mlops/train/ptq/train_ptq_integer.py', 'data/prepared', 'model/ptq/integer']
Prepared Dataset Folder Path: /Users/fabien/Library/CloudStorage/GoogleDrive-roth.fabien@gmail.com/My Drive/MSC_Datascience/02 - Courses/TSM-MachLeData/a-guide-to-mlops/data/prepared
Model Folder Path: /Users/fabien/Library/CloudStorage/GoogleDrive-roth.fabien@gmail.com/My Drive/MSC_Datascience/02 - Courses/TSM-MachLeData/a-guide-to-mlops/model/ptq/integer
Loading datasets...
Datasets loaded successfully.
Loading labels from /Users/fabien/Library/CloudStorage/GoogleDrive-roth.fabien@gmail.com/My Drive/MSC_Datascience/02 - Courses/TSM-MachLeData/a-guide-to-mlops/data/prepared/labels.json
Defining model...
/Users/fabien/Library/CloudStorage/GoogleDrive-roth.fabien@gmail.com/My Drive/MSC_Datascience/02 - Courses/TSM-MachLeData/a-guide-to-mlops/.venv/lib/python3.11/site-packages/keras/src/layers/convolutional/base_conv.py:107: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
Model: "sequential"
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ Layer (type)                    â”ƒ Output Shape           â”ƒ       Param # â”ƒ
â”¡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”©
â”‚ conv2d (Conv2D)                 â”‚ (None, 30, 30, 64)     â”‚           640 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ max_pooling2d (MaxPooling2D)    â”‚ (None, 10, 10, 64)     â”‚             0 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ flatten (Flatten)               â”‚ (None, 6400)           â”‚             0 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ dense (Dense)                   â”‚ (None, 128)            â”‚       819,328 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ dense_1 (Dense)                 â”‚ (None, 11)             â”‚         1,419 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
 Total params: 821,387 (3.13 MB)
 Trainable params: 821,387 (3.13 MB)
 Non-trainable params: 0 (0.00 B)
Starting training...
Epoch 1/10
[1m 1/41[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m25s[0m 640ms/step - loss: 2.4014 - sparse_categorical_accuracy: 0.1250[1m 4/41[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 2.3643 - sparse_categorical_accuracy: 0.1400  [1m 7/41[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 2.3591 - sparse_categorical_accuracy: 0.1396[1m10/41[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 2.3544 - sparse_categorical_accuracy: 0.1332[1m13/41[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 2.3467 - sparse_categorical_accuracy: 0.1281[1m16/41[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 2.3367 - sparse_categorical_accuracy: 0.1283[1m19/41[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 2.3272 - sparse_categorical_accuracy: 0.1319[1m22/41[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 2.3169 - sparse_categorical_accuracy: 0.1378[1m25/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 2.3070 - sparse_categorical_accuracy: 0.1433[1m28/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 2.2976 - sparse_categorical_accuracy: 0.1495[1m31/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 2.2872 - sparse_categorical_accuracy: 0.1575[1m34/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 18ms/step - loss: 2.2760 - sparse_categorical_accuracy: 0.1660[1m37/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 18ms/step - loss: 2.2640 - sparse_categorical_accuracy: 0.1748[1m40/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”[0m [1m0s[0m 18ms/step - loss: 2.2514 - sparse_categorical_accuracy: 0.1842[1m41/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 21ms/step - loss: 2.2431 - sparse_categorical_accuracy: 0.1903 - val_loss: 1.6360 - val_sparse_categorical_accuracy: 0.6636
Epoch 2/10
[1m 1/41[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 25ms/step - loss: 1.4402 - sparse_categorical_accuracy: 0.7812[1m 4/41[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 1.5063 - sparse_categorical_accuracy: 0.6419[1m 7/41[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 1.5135 - sparse_categorical_accuracy: 0.6030[1m10/41[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 1.5074 - sparse_categorical_accuracy: 0.5913[1m13/41[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 1.5013 - sparse_categorical_accuracy: 0.5817[1m16/41[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 1.4924 - sparse_categorical_accuracy: 0.5750[1m19/41[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 1.4797 - sparse_categorical_accuracy: 0.5762[1m22/41[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 1.4633 - sparse_categorical_accuracy: 0.5797[1m25/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 1.4480 - sparse_categorical_accuracy: 0.5823[1m28/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 1.4343 - sparse_categorical_accuracy: 0.5845[1m31/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 1.4213 - sparse_categorical_accuracy: 0.5870[1m34/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 18ms/step - loss: 1.4091 - sparse_categorical_accuracy: 0.5893[1m37/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 18ms/step - loss: 1.3966 - sparse_categorical_accuracy: 0.5918[1m40/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”[0m [1m0s[0m 18ms/step - loss: 1.3842 - sparse_categorical_accuracy: 0.5945[1m41/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 20ms/step - loss: 1.3763 - sparse_categorical_accuracy: 0.5961 - val_loss: 0.9386 - val_sparse_categorical_accuracy: 0.6820
Epoch 3/10
[1m 1/41[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 26ms/step - loss: 0.8177 - sparse_categorical_accuracy: 0.7188[1m 4/41[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.9616 - sparse_categorical_accuracy: 0.6452[1m 7/41[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.9653 - sparse_categorical_accuracy: 0.6633[1m10/41[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.9666 - sparse_categorical_accuracy: 0.6715[1m13/41[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.9649 - sparse_categorical_accuracy: 0.6766[1m16/41[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.9599 - sparse_categorical_accuracy: 0.6815[1m19/41[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.9516 - sparse_categorical_accuracy: 0.6872[1m22/41[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.9405 - sparse_categorical_accuracy: 0.6932[1m25/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.9305 - sparse_categorical_accuracy: 0.6976[1m28/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.9220 - sparse_categorical_accuracy: 0.7015[1m31/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.9137 - sparse_categorical_accuracy: 0.7048[1m34/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.9062 - sparse_categorical_accuracy: 0.7077[1m37/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 18ms/step - loss: 0.8984 - sparse_categorical_accuracy: 0.7106[1m40/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”[0m [1m0s[0m 18ms/step - loss: 0.8907 - sparse_categorical_accuracy: 0.7135[1m41/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 20ms/step - loss: 0.8859 - sparse_categorical_accuracy: 0.7153 - val_loss: 0.6795 - val_sparse_categorical_accuracy: 0.7492
Epoch 4/10
[1m 1/41[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 24ms/step - loss: 0.5344 - sparse_categorical_accuracy: 0.8438[1m 4/41[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.6800 - sparse_categorical_accuracy: 0.7897[1m 7/41[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.6911 - sparse_categorical_accuracy: 0.7943[1m10/41[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.6928 - sparse_categorical_accuracy: 0.7978[1m13/41[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.6918 - sparse_categorical_accuracy: 0.7972[1m16/41[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.6883 - sparse_categorical_accuracy: 0.7993[1m19/41[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.6818 - sparse_categorical_accuracy: 0.8023[1m22/41[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.6735 - sparse_categorical_accuracy: 0.8058[1m25/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.6663 - sparse_categorical_accuracy: 0.8088[1m28/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.6606 - sparse_categorical_accuracy: 0.8110[1m31/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.6553 - sparse_categorical_accuracy: 0.8125[1m34/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.6505 - sparse_categorical_accuracy: 0.8139[1m37/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 18ms/step - loss: 0.6454 - sparse_categorical_accuracy: 0.8154[1m40/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”[0m [1m0s[0m 18ms/step - loss: 0.6406 - sparse_categorical_accuracy: 0.8168[1m41/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 20ms/step - loss: 0.6376 - sparse_categorical_accuracy: 0.8177 - val_loss: 0.5152 - val_sparse_categorical_accuracy: 0.8838
Epoch 5/10
[1m 1/41[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 25ms/step - loss: 0.4261 - sparse_categorical_accuracy: 0.8438[1m 4/41[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.5282 - sparse_categorical_accuracy: 0.8223[1m 7/41[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.5395 - sparse_categorical_accuracy: 0.8211[1m10/41[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.5390 - sparse_categorical_accuracy: 0.8240[1m13/41[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.5366 - sparse_categorical_accuracy: 0.8271[1m16/41[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.5334 - sparse_categorical_accuracy: 0.8308[1m19/41[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.5280 - sparse_categorical_accuracy: 0.8348[1m22/41[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.5215 - sparse_categorical_accuracy: 0.8387[1m25/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.5160 - sparse_categorical_accuracy: 0.8419[1m28/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.5119 - sparse_categorical_accuracy: 0.8445[1m31/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.5080 - sparse_categorical_accuracy: 0.8463[1m34/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.5045 - sparse_categorical_accuracy: 0.8478[1m37/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 18ms/step - loss: 0.5008 - sparse_categorical_accuracy: 0.8493[1m40/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”[0m [1m0s[0m 18ms/step - loss: 0.4973 - sparse_categorical_accuracy: 0.8508[1m41/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 20ms/step - loss: 0.4951 - sparse_categorical_accuracy: 0.8517 - val_loss: 0.3982 - val_sparse_categorical_accuracy: 0.9174
Epoch 6/10
[1m 1/41[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 24ms/step - loss: 0.3051 - sparse_categorical_accuracy: 0.9375[1m 4/41[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.4089 - sparse_categorical_accuracy: 0.8926[1m 7/41[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.4295 - sparse_categorical_accuracy: 0.8725[1m10/41[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.4304 - sparse_categorical_accuracy: 0.8700[1m13/41[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.4298 - sparse_categorical_accuracy: 0.8698[1m16/41[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.4283 - sparse_categorical_accuracy: 0.8711[1m19/41[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.4247 - sparse_categorical_accuracy: 0.8741[1m22/41[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.4202 - sparse_categorical_accuracy: 0.8771[1m25/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.4162 - sparse_categorical_accuracy: 0.8799[1m28/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.4134 - sparse_categorical_accuracy: 0.8820[1m31/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.4105 - sparse_categorical_accuracy: 0.8841[1m34/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.4079 - sparse_categorical_accuracy: 0.8857[1m37/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 18ms/step - loss: 0.4051 - sparse_categorical_accuracy: 0.8873[1m40/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”[0m [1m0s[0m 18ms/step - loss: 0.4024 - sparse_categorical_accuracy: 0.8888[1m41/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 20ms/step - loss: 0.4008 - sparse_categorical_accuracy: 0.8897 - val_loss: 0.3429 - val_sparse_categorical_accuracy: 0.9266
Epoch 7/10
[1m 1/41[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 24ms/step - loss: 0.2725 - sparse_categorical_accuracy: 0.9375[1m 4/41[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.3596 - sparse_categorical_accuracy: 0.9121[1m 7/41[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.3706 - sparse_categorical_accuracy: 0.9062[1m10/41[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.3685 - sparse_categorical_accuracy: 0.9062[1m13/41[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.3647 - sparse_categorical_accuracy: 0.9068[1m16/41[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.3619 - sparse_categorical_accuracy: 0.9065[1m19/41[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.3576 - sparse_categorical_accuracy: 0.9071[1m22/41[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.3528 - sparse_categorical_accuracy: 0.9083[1m25/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.3486 - sparse_categorical_accuracy: 0.9096[1m28/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.3459 - sparse_categorical_accuracy: 0.9104[1m31/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.3430 - sparse_categorical_accuracy: 0.9114[1m34/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.3405 - sparse_categorical_accuracy: 0.9123[1m37/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 19ms/step - loss: 0.3379 - sparse_categorical_accuracy: 0.9132[1m40/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”[0m [1m0s[0m 19ms/step - loss: 0.3354 - sparse_categorical_accuracy: 0.9140[1m41/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 20ms/step - loss: 0.3339 - sparse_categorical_accuracy: 0.9146 - val_loss: 0.2768 - val_sparse_categorical_accuracy: 0.9419
Epoch 8/10
[1m 1/41[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 24ms/step - loss: 0.1760 - sparse_categorical_accuracy: 0.9375[1m 4/41[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.2817 - sparse_categorical_accuracy: 0.9251[1m 7/41[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.3012 - sparse_categorical_accuracy: 0.9227[1m10/41[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.3019 - sparse_categorical_accuracy: 0.9237[1m13/41[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.3012 - sparse_categorical_accuracy: 0.9243[1m16/41[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.2999 - sparse_categorical_accuracy: 0.9243[1m19/41[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.2974 - sparse_categorical_accuracy: 0.9243[1m22/41[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.2943 - sparse_categorical_accuracy: 0.9247[1m25/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.2917 - sparse_categorical_accuracy: 0.9254[1m28/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.2901 - sparse_categorical_accuracy: 0.9257[1m31/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.2883 - sparse_categorical_accuracy: 0.9261[1m34/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.2866 - sparse_categorical_accuracy: 0.9265[1m37/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 19ms/step - loss: 0.2848 - sparse_categorical_accuracy: 0.9269[1m40/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”[0m [1m0s[0m 18ms/step - loss: 0.2833 - sparse_categorical_accuracy: 0.9272[1m41/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 20ms/step - loss: 0.2824 - sparse_categorical_accuracy: 0.9275 - val_loss: 0.2389 - val_sparse_categorical_accuracy: 0.9511
Epoch 9/10
[1m 1/41[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 24ms/step - loss: 0.1192 - sparse_categorical_accuracy: 1.0000[1m 4/41[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2257 - sparse_categorical_accuracy: 0.9661[1m 7/41[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2488 - sparse_categorical_accuracy: 0.9553[1m10/41[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2516 - sparse_categorical_accuracy: 0.9520[1m13/41[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2513 - sparse_categorical_accuracy: 0.9497[1m16/41[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2503 - sparse_categorical_accuracy: 0.9476[1m19/41[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2488 - sparse_categorical_accuracy: 0.9456[1m22/41[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2468 - sparse_categorical_accuracy: 0.9447[1m25/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2452 - sparse_categorical_accuracy: 0.9444[1m28/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2441 - sparse_categorical_accuracy: 0.9439[1m31/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2428 - sparse_categorical_accuracy: 0.9437[1m34/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2416 - sparse_categorical_accuracy: 0.9436[1m37/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 18ms/step - loss: 0.2404 - sparse_categorical_accuracy: 0.9435[1m40/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”[0m [1m0s[0m 18ms/step - loss: 0.2394 - sparse_categorical_accuracy: 0.9433[1m41/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 20ms/step - loss: 0.2389 - sparse_categorical_accuracy: 0.9431 - val_loss: 0.2406 - val_sparse_categorical_accuracy: 0.9266
Epoch 10/10
[1m 1/41[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m1s[0m 26ms/step - loss: 0.0933 - sparse_categorical_accuracy: 1.0000[1m 4/41[0m [32mâ”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2196 - sparse_categorical_accuracy: 0.9453[1m 7/41[0m [32mâ”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2372 - sparse_categorical_accuracy: 0.9402[1m10/41[0m [32mâ”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2419 - sparse_categorical_accuracy: 0.9383[1m13/41[0m [32mâ”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2413 - sparse_categorical_accuracy: 0.9374[1m16/41[0m [32mâ”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.2405 - sparse_categorical_accuracy: 0.9369[1m19/41[0m [32mâ”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2396 - sparse_categorical_accuracy: 0.9366[1m22/41[0m [32mâ”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2378 - sparse_categorical_accuracy: 0.9369[1m25/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.2365 - sparse_categorical_accuracy: 0.9373[1m28/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”[0m [1m0s[0m 19ms/step - loss: 0.2352 - sparse_categorical_accuracy: 0.9377[1m31/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2337 - sparse_categorical_accuracy: 0.9385[1m34/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”[0m [1m0s[0m 18ms/step - loss: 0.2324 - sparse_categorical_accuracy: 0.9390[1m37/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”[0m [1m0s[0m 19ms/step - loss: 0.2313 - sparse_categorical_accuracy: 0.9394[1m40/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”[0m [1m0s[0m 19ms/step - loss: 0.2305 - sparse_categorical_accuracy: 0.9396[1m41/41[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m1s[0m 20ms/step - loss: 0.2300 - sparse_categorical_accuracy: 0.9396 - val_loss: 0.2670 - val_sparse_categorical_accuracy: 0.9083
Applying Full Integer Quantization...
Saved artifact at '/var/folders/0y/czyrd9qx7yb0z904_86qw5z00000gn/T/tmpe_c4zaz8'. The following endpoints are available:

* Endpoint 'serve'
  args_0 (POSITIONAL_ONLY): TensorSpec(shape=(None, 32, 32, 1), dtype=tf.float32, name='keras_tensor')
Output Type:
  TensorSpec(shape=(None, 11), dtype=tf.float32, name=None)
Captures:
  5877313616: TensorSpec(shape=(), dtype=tf.resource, name=None)
  5877315344: TensorSpec(shape=(), dtype=tf.resource, name=None)
  5877315536: TensorSpec(shape=(), dtype=tf.resource, name=None)
  5877314960: TensorSpec(shape=(), dtype=tf.resource, name=None)
  5877316496: TensorSpec(shape=(), dtype=tf.resource, name=None)
  5877316112: TensorSpec(shape=(), dtype=tf.resource, name=None)
/Users/fabien/Library/CloudStorage/GoogleDrive-roth.fabien@gmail.com/My Drive/MSC_Datascience/02 - Courses/TSM-MachLeData/a-guide-to-mlops/.venv/lib/python3.11/site-packages/tensorflow/lite/python/convert.py:997: UserWarning: Statistics for quantized inputs were expected, but not specified; continuing anyway.
  warnings.warn(
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
W0000 00:00:1731532417.946629  872459 tf_tfl_flatbuffer_helpers.cc:365] Ignored output_format.
W0000 00:00:1731532417.946651  872459 tf_tfl_flatbuffer_helpers.cc:368] Ignored drop_control_dependency.
2024-11-13 22:13:37.946943: I tensorflow/cc/saved_model/reader.cc:83] Reading SavedModel from: /var/folders/0y/czyrd9qx7yb0z904_86qw5z00000gn/T/tmpe_c4zaz8
2024-11-13 22:13:37.947265: I tensorflow/cc/saved_model/reader.cc:52] Reading meta graph with tags { serve }
2024-11-13 22:13:37.947278: I tensorflow/cc/saved_model/reader.cc:147] Reading SavedModel debug info (if present) from: /var/folders/0y/czyrd9qx7yb0z904_86qw5z00000gn/T/tmpe_c4zaz8
I0000 00:00:1731532417.949143  872459 mlir_graph_optimization_pass.cc:401] MLIR V1 optimization pass is not enabled
2024-11-13 22:13:37.949522: I tensorflow/cc/saved_model/loader.cc:236] Restoring SavedModel bundle.
2024-11-13 22:13:37.964553: I tensorflow/cc/saved_model/loader.cc:220] Running initialization op on SavedModel bundle at path: /var/folders/0y/czyrd9qx7yb0z904_86qw5z00000gn/T/tmpe_c4zaz8
2024-11-13 22:13:37.968818: I tensorflow/cc/saved_model/loader.cc:466] SavedModel load for tags { serve }; Status: success: OK. Took 21878 microseconds.
2024-11-13 22:13:37.973586: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:268] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2024-11-13 22:13:39.781536: I tensorflow/core/framework/local_rendezvous.cc:405] Local rendezvous is aborting with status: OUT_OF_RANGE: End of sequence
fully_quantize: 0, inference_type: 6, input_inference_type: INT8, output_inference_type: INT8
Saving the model using BentoML...
Exporting the model...

Model, TFLite model, and training history saved at /Users/fabien/Library/CloudStorage/GoogleDrive-roth.fabien@gmail.com/My Drive/MSC_Datascience/02 - Courses/TSM-MachLeData/a-guide-to-mlops/model/ptq/integer
Updating lock file 'dvc.lock'

Running stage 'qat_dynamic_train':
> python3.11 a_guide_to_mlops/train/qat/train_qat_dynamic.py data/prepared model/qat/dynamic
Script started...
Prepared Dataset Folder Path: /Users/fabien/Library/CloudStorage/GoogleDrive-roth.fabien@gmail.com/My Drive/MSC_Datascience/02 - Courses/TSM-MachLeData/a-guide-to-mlops/data/prepared
Model Folder Path: /Users/fabien/Library/CloudStorage/GoogleDrive-roth.fabien@gmail.com/My Drive/MSC_Datascience/02 - Courses/TSM-MachLeData/a-guide-to-mlops/model/qat/dynamic
Loading datasets...
Datasets loaded successfully.
Labels loaded from /Users/fabien/Library/CloudStorage/GoogleDrive-roth.fabien@gmail.com/My Drive/MSC_Datascience/02 - Courses/TSM-MachLeData/a-guide-to-mlops/data/prepared/labels.json
Defining model and applying QAT...
WARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.Adam` runs slowly on M1/M2 Macs, please use the legacy TF-Keras optimizer instead, located at `tf.keras.optimizers.legacy.Adam`.
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 quantize_layer (QuantizeLa  (None, 32, 32, 1)         3         
 yer)                                                            
                                                                 
 quant_conv2d (QuantizeWrap  (None, 30, 30, 64)        771       
 perV2)                                                          
                                                                 
 quant_max_pooling2d (Quant  (None, 10, 10, 64)        1         
 izeWrapperV2)                                                   
                                                                 
 quant_flatten (QuantizeWra  (None, 6400)              1         
 pperV2)                                                         
                                                                 
 quant_dense (QuantizeWrapp  (None, 128)               819333    
 erV2)                                                           
                                                                 
 quant_dense_1 (QuantizeWra  (None, 11)                1424      
 pperV2)                                                         
                                                                 
=================================================================
Total params: 821533 (3.13 MB)
Trainable params: 821387 (3.13 MB)
Non-trainable params: 146 (584.00 Byte)
_________________________________________________________________
Starting QAT training...
Epoch 1/10
 1/41 [..............................] - ETA: 23s - loss: 2.3993 - sparse_categorical_accuracy: 0.0625 4/41 [=>............................] - ETA: 0s - loss: 2.3308 - sparse_categorical_accuracy: 0.1250  7/41 [====>.........................] - ETA: 0s - loss: 2.3602 - sparse_categorical_accuracy: 0.098210/41 [======>.......................] - ETA: 0s - loss: 2.3160 - sparse_categorical_accuracy: 0.106313/41 [========>.....................] - ETA: 0s - loss: 2.2920 - sparse_categorical_accuracy: 0.108216/41 [==========>...................] - ETA: 0s - loss: 2.2649 - sparse_categorical_accuracy: 0.125019/41 [============>.................] - ETA: 0s - loss: 2.2394 - sparse_categorical_accuracy: 0.139821/41 [==============>...............] - ETA: 0s - loss: 2.2228 - sparse_categorical_accuracy: 0.169624/41 [================>.............] - ETA: 0s - loss: 2.2021 - sparse_categorical_accuracy: 0.179727/41 [==================>...........] - ETA: 0s - loss: 2.1848 - sparse_categorical_accuracy: 0.199130/41 [====================>.........] - ETA: 0s - loss: 2.1574 - sparse_categorical_accuracy: 0.231333/41 [=======================>......] - ETA: 0s - loss: 2.1277 - sparse_categorical_accuracy: 0.256636/41 [=========================>....] - ETA: 0s - loss: 2.0989 - sparse_categorical_accuracy: 0.278639/41 [===========================>..] - ETA: 0s - loss: 2.0698 - sparse_categorical_accuracy: 0.302141/41 [==============================] - 2s 30ms/step - loss: 2.0477 - sparse_categorical_accuracy: 0.3115 - val_loss: 1.6760 - val_sparse_categorical_accuracy: 0.5627
Epoch 2/10
 1/41 [..............................] - ETA: 0s - loss: 1.3908 - sparse_categorical_accuracy: 0.7500 4/41 [=>............................] - ETA: 0s - loss: 1.5220 - sparse_categorical_accuracy: 0.5391 7/41 [====>.........................] - ETA: 0s - loss: 1.5396 - sparse_categorical_accuracy: 0.486610/41 [======>.......................] - ETA: 0s - loss: 1.5077 - sparse_categorical_accuracy: 0.509413/41 [========>.....................] - ETA: 0s - loss: 1.5022 - sparse_categorical_accuracy: 0.497616/41 [==========>...................] - ETA: 0s - loss: 1.4810 - sparse_categorical_accuracy: 0.515619/41 [============>.................] - ETA: 0s - loss: 1.4242 - sparse_categorical_accuracy: 0.547722/41 [===============>..............] - ETA: 0s - loss: 1.3778 - sparse_categorical_accuracy: 0.555425/41 [=================>............] - ETA: 0s - loss: 1.3591 - sparse_categorical_accuracy: 0.557528/41 [===================>..........] - ETA: 0s - loss: 1.3305 - sparse_categorical_accuracy: 0.577031/41 [=====================>........] - ETA: 0s - loss: 1.3058 - sparse_categorical_accuracy: 0.586734/41 [=======================>......] - ETA: 0s - loss: 1.2831 - sparse_categorical_accuracy: 0.594737/41 [==========================>...] - ETA: 0s - loss: 1.2517 - sparse_categorical_accuracy: 0.601440/41 [============================>.] - ETA: 0s - loss: 1.2286 - sparse_categorical_accuracy: 0.605541/41 [==============================] - 1s 25ms/step - loss: 1.2207 - sparse_categorical_accuracy: 0.6084 - val_loss: 0.9167 - val_sparse_categorical_accuracy: 0.7339
Epoch 3/10
 1/41 [..............................] - ETA: 0s - loss: 0.7454 - sparse_categorical_accuracy: 0.7500 4/41 [=>............................] - ETA: 0s - loss: 0.9164 - sparse_categorical_accuracy: 0.7188 7/41 [====>.........................] - ETA: 0s - loss: 0.9237 - sparse_categorical_accuracy: 0.705410/41 [======>.......................] - ETA: 0s - loss: 0.9120 - sparse_categorical_accuracy: 0.696913/41 [========>.....................] - ETA: 0s - loss: 0.9247 - sparse_categorical_accuracy: 0.687516/41 [==========>...................] - ETA: 0s - loss: 0.9061 - sparse_categorical_accuracy: 0.714819/41 [============>.................] - ETA: 0s - loss: 0.8606 - sparse_categorical_accuracy: 0.738522/41 [===============>..............] - ETA: 0s - loss: 0.8306 - sparse_categorical_accuracy: 0.758525/41 [=================>............] - ETA: 0s - loss: 0.8223 - sparse_categorical_accuracy: 0.763828/41 [===================>..........] - ETA: 0s - loss: 0.8066 - sparse_categorical_accuracy: 0.771231/41 [=====================>........] - ETA: 0s - loss: 0.7896 - sparse_categorical_accuracy: 0.779234/41 [=======================>......] - ETA: 0s - loss: 0.7806 - sparse_categorical_accuracy: 0.782237/41 [==========================>...] - ETA: 0s - loss: 0.7602 - sparse_categorical_accuracy: 0.789740/41 [============================>.] - ETA: 0s - loss: 0.7495 - sparse_categorical_accuracy: 0.790641/41 [==============================] - 1s 25ms/step - loss: 0.7467 - sparse_categorical_accuracy: 0.7908 - val_loss: 0.5849 - val_sparse_categorical_accuracy: 0.8287
Epoch 4/10
 1/41 [..............................] - ETA: 0s - loss: 0.4047 - sparse_categorical_accuracy: 0.9062 4/41 [=>............................] - ETA: 0s - loss: 0.5827 - sparse_categorical_accuracy: 0.8516 7/41 [====>.........................] - ETA: 0s - loss: 0.6135 - sparse_categorical_accuracy: 0.857110/41 [======>.......................] - ETA: 0s - loss: 0.5973 - sparse_categorical_accuracy: 0.856213/41 [========>.....................] - ETA: 0s - loss: 0.6082 - sparse_categorical_accuracy: 0.838916/41 [==========>...................] - ETA: 0s - loss: 0.6014 - sparse_categorical_accuracy: 0.847719/41 [============>.................] - ETA: 0s - loss: 0.5672 - sparse_categorical_accuracy: 0.865122/41 [===============>..............] - ETA: 0s - loss: 0.5493 - sparse_categorical_accuracy: 0.873625/41 [=================>............] - ETA: 0s - loss: 0.5479 - sparse_categorical_accuracy: 0.872528/41 [===================>..........] - ETA: 0s - loss: 0.5368 - sparse_categorical_accuracy: 0.875031/41 [=====================>........] - ETA: 0s - loss: 0.5306 - sparse_categorical_accuracy: 0.879034/41 [=======================>......] - ETA: 0s - loss: 0.5256 - sparse_categorical_accuracy: 0.879637/41 [==========================>...] - ETA: 0s - loss: 0.5151 - sparse_categorical_accuracy: 0.879240/41 [============================>.] - ETA: 0s - loss: 0.5104 - sparse_categorical_accuracy: 0.878141/41 [==============================] - 1s 25ms/step - loss: 0.5096 - sparse_categorical_accuracy: 0.8786 - val_loss: 0.4373 - val_sparse_categorical_accuracy: 0.9021
Epoch 5/10
 1/41 [..............................] - ETA: 0s - loss: 0.3056 - sparse_categorical_accuracy: 0.9375 4/41 [=>............................] - ETA: 0s - loss: 0.4351 - sparse_categorical_accuracy: 0.8906 7/41 [====>.........................] - ETA: 0s - loss: 0.4785 - sparse_categorical_accuracy: 0.879510/41 [======>.......................] - ETA: 0s - loss: 0.4657 - sparse_categorical_accuracy: 0.878113/41 [========>.....................] - ETA: 0s - loss: 0.4775 - sparse_categorical_accuracy: 0.860616/41 [==========>...................] - ETA: 0s - loss: 0.4734 - sparse_categorical_accuracy: 0.863319/41 [============>.................] - ETA: 0s - loss: 0.4491 - sparse_categorical_accuracy: 0.876622/41 [===============>..............] - ETA: 0s - loss: 0.4358 - sparse_categorical_accuracy: 0.883525/41 [=================>............] - ETA: 0s - loss: 0.4308 - sparse_categorical_accuracy: 0.886328/41 [===================>..........] - ETA: 0s - loss: 0.4240 - sparse_categorical_accuracy: 0.888431/41 [=====================>........] - ETA: 0s - loss: 0.4164 - sparse_categorical_accuracy: 0.894234/41 [=======================>......] - ETA: 0s - loss: 0.4129 - sparse_categorical_accuracy: 0.894337/41 [==========================>...] - ETA: 0s - loss: 0.4038 - sparse_categorical_accuracy: 0.896140/41 [============================>.] - ETA: 0s - loss: 0.4001 - sparse_categorical_accuracy: 0.899241/41 [==============================] - 1s 25ms/step - loss: 0.4003 - sparse_categorical_accuracy: 0.8992 - val_loss: 0.3588 - val_sparse_categorical_accuracy: 0.9144
Epoch 6/10
 1/41 [..............................] - ETA: 0s - loss: 0.2451 - sparse_categorical_accuracy: 0.9375 4/41 [=>............................] - ETA: 0s - loss: 0.3578 - sparse_categorical_accuracy: 0.9141 7/41 [====>.........................] - ETA: 0s - loss: 0.3898 - sparse_categorical_accuracy: 0.924110/41 [======>.......................] - ETA: 0s - loss: 0.3809 - sparse_categorical_accuracy: 0.928113/41 [========>.....................] - ETA: 0s - loss: 0.3886 - sparse_categorical_accuracy: 0.911116/41 [==========>...................] - ETA: 0s - loss: 0.3896 - sparse_categorical_accuracy: 0.910219/41 [============>.................] - ETA: 0s - loss: 0.3664 - sparse_categorical_accuracy: 0.916121/41 [==============>...............] - ETA: 0s - loss: 0.3597 - sparse_categorical_accuracy: 0.916724/41 [================>.............] - ETA: 0s - loss: 0.3492 - sparse_categorical_accuracy: 0.921927/41 [==================>...........] - ETA: 0s - loss: 0.3468 - sparse_categorical_accuracy: 0.921330/41 [====================>.........] - ETA: 0s - loss: 0.3365 - sparse_categorical_accuracy: 0.925033/41 [=======================>......] - ETA: 0s - loss: 0.3346 - sparse_categorical_accuracy: 0.924236/41 [=========================>....] - ETA: 0s - loss: 0.3265 - sparse_categorical_accuracy: 0.927139/41 [===========================>..] - ETA: 0s - loss: 0.3253 - sparse_categorical_accuracy: 0.926341/41 [==============================] - 1s 25ms/step - loss: 0.3223 - sparse_categorical_accuracy: 0.9282 - val_loss: 0.3004 - val_sparse_categorical_accuracy: 0.9266
Epoch 7/10
 1/41 [..............................] - ETA: 0s - loss: 0.2192 - sparse_categorical_accuracy: 0.9375 4/41 [=>............................] - ETA: 0s - loss: 0.3014 - sparse_categorical_accuracy: 0.9375 7/41 [====>.........................] - ETA: 0s - loss: 0.3275 - sparse_categorical_accuracy: 0.937510/41 [======>.......................] - ETA: 0s - loss: 0.3199 - sparse_categorical_accuracy: 0.940613/41 [========>.....................] - ETA: 0s - loss: 0.3227 - sparse_categorical_accuracy: 0.932716/41 [==========>...................] - ETA: 0s - loss: 0.3212 - sparse_categorical_accuracy: 0.933619/41 [============>.................] - ETA: 0s - loss: 0.3043 - sparse_categorical_accuracy: 0.935922/41 [===============>..............] - ETA: 0s - loss: 0.2970 - sparse_categorical_accuracy: 0.936125/41 [=================>............] - ETA: 0s - loss: 0.2911 - sparse_categorical_accuracy: 0.938828/41 [===================>..........] - ETA: 0s - loss: 0.2880 - sparse_categorical_accuracy: 0.937531/41 [=====================>........] - ETA: 0s - loss: 0.2817 - sparse_categorical_accuracy: 0.940534/41 [=======================>......] - ETA: 0s - loss: 0.2781 - sparse_categorical_accuracy: 0.939337/41 [==========================>...] - ETA: 0s - loss: 0.2736 - sparse_categorical_accuracy: 0.940039/41 [===========================>..] - ETA: 0s - loss: 0.2763 - sparse_categorical_accuracy: 0.939141/41 [==============================] - 1s 25ms/step - loss: 0.2734 - sparse_categorical_accuracy: 0.9405 - val_loss: 0.2520 - val_sparse_categorical_accuracy: 0.9419
Epoch 8/10
 1/41 [..............................] - ETA: 0s - loss: 0.1758 - sparse_categorical_accuracy: 0.9688 4/41 [=>............................] - ETA: 0s - loss: 0.2604 - sparse_categorical_accuracy: 0.9688 5/41 [==>...........................] - ETA: 1s - loss: 0.3095 - sparse_categorical_accuracy: 0.9688 7/41 [====>.........................] - ETA: 1s - loss: 0.2861 - sparse_categorical_accuracy: 0.964310/41 [======>.......................] - ETA: 0s - loss: 0.2786 - sparse_categorical_accuracy: 0.962513/41 [========>.....................] - ETA: 0s - loss: 0.2847 - sparse_categorical_accuracy: 0.947116/41 [==========>...................] - ETA: 0s - loss: 0.2796 - sparse_categorical_accuracy: 0.947319/41 [============>.................] - ETA: 0s - loss: 0.2676 - sparse_categorical_accuracy: 0.949022/41 [===============>..............] - ETA: 0s - loss: 0.2603 - sparse_categorical_accuracy: 0.953125/41 [=================>............] - ETA: 0s - loss: 0.2553 - sparse_categorical_accuracy: 0.956328/41 [===================>..........] - ETA: 0s - loss: 0.2529 - sparse_categorical_accuracy: 0.952031/41 [=====================>........] - ETA: 0s - loss: 0.2455 - sparse_categorical_accuracy: 0.954634/41 [=======================>......] - ETA: 0s - loss: 0.2418 - sparse_categorical_accuracy: 0.953137/41 [==========================>...] - ETA: 0s - loss: 0.2374 - sparse_categorical_accuracy: 0.951940/41 [============================>.] - ETA: 0s - loss: 0.2379 - sparse_categorical_accuracy: 0.951641/41 [==============================] - 1s 27ms/step - loss: 0.2377 - sparse_categorical_accuracy: 0.9511 - val_loss: 0.2054 - val_sparse_categorical_accuracy: 0.9633
Epoch 9/10
 1/41 [..............................] - ETA: 0s - loss: 0.1362 - sparse_categorical_accuracy: 1.0000 4/41 [=>............................] - ETA: 0s - loss: 0.2103 - sparse_categorical_accuracy: 0.9766 7/41 [====>.........................] - ETA: 0s - loss: 0.2421 - sparse_categorical_accuracy: 0.973210/41 [======>.......................] - ETA: 0s - loss: 0.2354 - sparse_categorical_accuracy: 0.971913/41 [========>.....................] - ETA: 0s - loss: 0.2384 - sparse_categorical_accuracy: 0.959116/41 [==========>...................] - ETA: 0s - loss: 0.2308 - sparse_categorical_accuracy: 0.960919/41 [============>.................] - ETA: 0s - loss: 0.2215 - sparse_categorical_accuracy: 0.962222/41 [===============>..............] - ETA: 0s - loss: 0.2168 - sparse_categorical_accuracy: 0.964525/41 [=================>............] - ETA: 0s - loss: 0.2134 - sparse_categorical_accuracy: 0.966328/41 [===================>..........] - ETA: 0s - loss: 0.2106 - sparse_categorical_accuracy: 0.963231/41 [=====================>........] - ETA: 0s - loss: 0.2048 - sparse_categorical_accuracy: 0.966734/41 [=======================>......] - ETA: 0s - loss: 0.2016 - sparse_categorical_accuracy: 0.965137/41 [==========================>...] - ETA: 0s - loss: 0.1986 - sparse_categorical_accuracy: 0.964540/41 [============================>.] - ETA: 0s - loss: 0.1997 - sparse_categorical_accuracy: 0.963341/41 [==============================] - 1s 25ms/step - loss: 0.1995 - sparse_categorical_accuracy: 0.9626 - val_loss: 0.1850 - val_sparse_categorical_accuracy: 0.9664
Epoch 10/10
 1/41 [..............................] - ETA: 0s - loss: 0.1087 - sparse_categorical_accuracy: 1.0000 4/41 [=>............................] - ETA: 0s - loss: 0.1913 - sparse_categorical_accuracy: 0.9766 7/41 [====>.........................] - ETA: 0s - loss: 0.2257 - sparse_categorical_accuracy: 0.9688 9/41 [=====>........................] - ETA: 0s - loss: 0.2102 - sparse_categorical_accuracy: 0.972212/41 [=======>......................] - ETA: 0s - loss: 0.2248 - sparse_categorical_accuracy: 0.955715/41 [=========>....................] - ETA: 0s - loss: 0.2173 - sparse_categorical_accuracy: 0.956318/41 [============>.................] - ETA: 0s - loss: 0.2092 - sparse_categorical_accuracy: 0.954921/41 [==============>...............] - ETA: 0s - loss: 0.2014 - sparse_categorical_accuracy: 0.958324/41 [================>.............] - ETA: 0s - loss: 0.1986 - sparse_categorical_accuracy: 0.957027/41 [==================>...........] - ETA: 0s - loss: 0.1976 - sparse_categorical_accuracy: 0.956029/41 [====================>.........] - ETA: 0s - loss: 0.1924 - sparse_categorical_accuracy: 0.959131/41 [=====================>........] - ETA: 0s - loss: 0.1887 - sparse_categorical_accuracy: 0.961734/41 [=======================>......] - ETA: 0s - loss: 0.1860 - sparse_categorical_accuracy: 0.960537/41 [==========================>...] - ETA: 0s - loss: 0.1843 - sparse_categorical_accuracy: 0.959540/41 [============================>.] - ETA: 0s - loss: 0.1864 - sparse_categorical_accuracy: 0.957841/41 [==============================] - 1s 26ms/step - loss: 0.1862 - sparse_categorical_accuracy: 0.9580 - val_loss: 0.1688 - val_sparse_categorical_accuracy: 0.9694
Training history saved at /Users/fabien/Library/CloudStorage/GoogleDrive-roth.fabien@gmail.com/My Drive/MSC_Datascience/02 - Courses/TSM-MachLeData/a-guide-to-mlops/model/qat/dynamic/history.npy
Model saved in Keras format at /Users/fabien/Library/CloudStorage/GoogleDrive-roth.fabien@gmail.com/My Drive/MSC_Datascience/02 - Courses/TSM-MachLeData/a-guide-to-mlops/model/qat/dynamic/celestial_bodies_classifier_model_qat_dynamic.keras
Converting model to ONNX...
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1731532440.981079  874293 devices.cc:76] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 0 (Note: TensorFlow was not compiled with CUDA or ROCm support)
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1731532440.981158  874293 single_machine.cc:361] Starting new session
I0000 00:00:1731532441.055232  874293 devices.cc:76] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 0 (Note: TensorFlow was not compiled with CUDA or ROCm support)
I0000 00:00:1731532441.055302  874293 single_machine.cc:361] Starting new session
I0000 00:00:1731532441.094539  874293 mlir_graph_optimization_pass.cc:401] MLIR V1 optimization pass is not enabled
Model converted to ONNX and saved at /Users/fabien/Library/CloudStorage/GoogleDrive-roth.fabien@gmail.com/My Drive/MSC_Datascience/02 - Courses/TSM-MachLeData/a-guide-to-mlops/model/qat/dynamic/celestial_bodies_classifier_model_qat_dynamic.onnx
Applying dynamic quantization to ONNX model...
WARNING:root:Please consider to run pre-processing before quantization. Refer to example: https://github.com/microsoft/onnxruntime-inference-examples/blob/main/quantization/image_classification/cpu/ReadMe.md 
WARNING:root:Please check if the model is already quantized. Note you don't need to quantize a QAT model. OnnxRuntime support to run QAT model directly.
Quantized ONNX model saved at /Users/fabien/Library/CloudStorage/GoogleDrive-roth.fabien@gmail.com/My Drive/MSC_Datascience/02 - Courses/TSM-MachLeData/a-guide-to-mlops/model/qat/dynamic/celestial_bodies_classifier_model_qat_dynamic_quantized.onnx
Saving ONNX model with BentoML...
Quantized ONNX model successfully saved to BentoML store.
Exporting the BentoML model...
BentoML model exported at /Users/fabien/Library/CloudStorage/GoogleDrive-roth.fabien@gmail.com/My Drive/MSC_Datascience/02 - Courses/TSM-MachLeData/a-guide-to-mlops/model/qat/dynamic
Updating lock file 'dvc.lock'

Running stage 'qat_float16_train':
> python3.11 a_guide_to_mlops/train/qat/train_qat_float16.py data/prepared model/qat/float16
Prepared Dataset Folder Path: data/prepared
Model Folder Path: model/qat/float16
Loading datasets...
Datasets loaded successfully.
Loading labels from data/prepared/labels.json
Defining model and applying QAT...
Compiling quantized model...
WARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.Adam` runs slowly on M1/M2 Macs, please use the legacy TF-Keras optimizer instead, located at `tf.keras.optimizers.legacy.Adam`.
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 quantize_layer (QuantizeLa  (None, 32, 32, 1)         3         
 yer)                                                            
                                                                 
 quant_conv2d (QuantizeWrap  (None, 30, 30, 64)        771       
 perV2)                                                          
                                                                 
 quant_max_pooling2d (Quant  (None, 10, 10, 64)        1         
 izeWrapperV2)                                                   
                                                                 
 quant_flatten (QuantizeWra  (None, 6400)              1         
 pperV2)                                                         
                                                                 
 quant_dense (QuantizeWrapp  (None, 128)               819333    
 erV2)                                                           
                                                                 
 quant_dense_1 (QuantizeWra  (None, 11)                1424      
 pperV2)                                                         
                                                                 
=================================================================
Total params: 821533 (3.13 MB)
Trainable params: 821387 (3.13 MB)
Non-trainable params: 146 (584.00 Byte)
_________________________________________________________________
Starting QAT training...
Epoch 1/10
 1/41 [..............................] - ETA: 27s - loss: 2.3993 - sparse_categorical_accuracy: 0.0625 4/41 [=>............................] - ETA: 0s - loss: 2.3308 - sparse_categorical_accuracy: 0.1250  7/41 [====>.........................] - ETA: 0s - loss: 2.3602 - sparse_categorical_accuracy: 0.098210/41 [======>.......................] - ETA: 0s - loss: 2.3160 - sparse_categorical_accuracy: 0.106313/41 [========>.....................] - ETA: 0s - loss: 2.2920 - sparse_categorical_accuracy: 0.108216/41 [==========>...................] - ETA: 0s - loss: 2.2649 - sparse_categorical_accuracy: 0.125019/41 [============>.................] - ETA: 0s - loss: 2.2394 - sparse_categorical_accuracy: 0.139822/41 [===============>..............] - ETA: 0s - loss: 2.2180 - sparse_categorical_accuracy: 0.176125/41 [=================>............] - ETA: 0s - loss: 2.2006 - sparse_categorical_accuracy: 0.181328/41 [===================>..........] - ETA: 0s - loss: 2.1789 - sparse_categorical_accuracy: 0.207631/41 [=====================>........] - ETA: 0s - loss: 2.1478 - sparse_categorical_accuracy: 0.240934/41 [=======================>......] - ETA: 0s - loss: 2.1185 - sparse_categorical_accuracy: 0.266537/41 [==========================>...] - ETA: 0s - loss: 2.0869 - sparse_categorical_accuracy: 0.288940/41 [============================>.] - ETA: 0s - loss: 2.0554 - sparse_categorical_accuracy: 0.310941/41 [==============================] - 2s 27ms/step - loss: 2.0477 - sparse_categorical_accuracy: 0.3115 - val_loss: 1.6760 - val_sparse_categorical_accuracy: 0.5627
Epoch 2/10
 1/41 [..............................] - ETA: 0s - loss: 1.3908 - sparse_categorical_accuracy: 0.7500 4/41 [=>............................] - ETA: 0s - loss: 1.5220 - sparse_categorical_accuracy: 0.5391 7/41 [====>.........................] - ETA: 0s - loss: 1.5396 - sparse_categorical_accuracy: 0.486610/41 [======>.......................] - ETA: 0s - loss: 1.5077 - sparse_categorical_accuracy: 0.509413/41 [========>.....................] - ETA: 0s - loss: 1.5022 - sparse_categorical_accuracy: 0.497616/41 [==========>...................] - ETA: 0s - loss: 1.4810 - sparse_categorical_accuracy: 0.515619/41 [============>.................] - ETA: 0s - loss: 1.4242 - sparse_categorical_accuracy: 0.547722/41 [===============>..............] - ETA: 0s - loss: 1.3778 - sparse_categorical_accuracy: 0.555425/41 [=================>............] - ETA: 0s - loss: 1.3591 - sparse_categorical_accuracy: 0.557528/41 [===================>..........] - ETA: 0s - loss: 1.3305 - sparse_categorical_accuracy: 0.577031/41 [=====================>........] - ETA: 0s - loss: 1.3058 - sparse_categorical_accuracy: 0.586734/41 [=======================>......] - ETA: 0s - loss: 1.2831 - sparse_categorical_accuracy: 0.594737/41 [==========================>...] - ETA: 0s - loss: 1.2517 - sparse_categorical_accuracy: 0.601440/41 [============================>.] - ETA: 0s - loss: 1.2286 - sparse_categorical_accuracy: 0.605541/41 [==============================] - 1s 24ms/step - loss: 1.2207 - sparse_categorical_accuracy: 0.6084 - val_loss: 0.9167 - val_sparse_categorical_accuracy: 0.7339
Epoch 3/10
 1/41 [..............................] - ETA: 0s - loss: 0.7454 - sparse_categorical_accuracy: 0.7500 4/41 [=>............................] - ETA: 0s - loss: 0.9164 - sparse_categorical_accuracy: 0.7188 7/41 [====>.........................] - ETA: 0s - loss: 0.9237 - sparse_categorical_accuracy: 0.705410/41 [======>.......................] - ETA: 0s - loss: 0.9120 - sparse_categorical_accuracy: 0.696913/41 [========>.....................] - ETA: 0s - loss: 0.9247 - sparse_categorical_accuracy: 0.687516/41 [==========>...................] - ETA: 0s - loss: 0.9061 - sparse_categorical_accuracy: 0.714819/41 [============>.................] - ETA: 0s - loss: 0.8606 - sparse_categorical_accuracy: 0.738522/41 [===============>..............] - ETA: 0s - loss: 0.8306 - sparse_categorical_accuracy: 0.758525/41 [=================>............] - ETA: 0s - loss: 0.8223 - sparse_categorical_accuracy: 0.763828/41 [===================>..........] - ETA: 0s - loss: 0.8066 - sparse_categorical_accuracy: 0.771231/41 [=====================>........] - ETA: 0s - loss: 0.7896 - sparse_categorical_accuracy: 0.779234/41 [=======================>......] - ETA: 0s - loss: 0.7806 - sparse_categorical_accuracy: 0.782237/41 [==========================>...] - ETA: 0s - loss: 0.7602 - sparse_categorical_accuracy: 0.789740/41 [============================>.] - ETA: 0s - loss: 0.7495 - sparse_categorical_accuracy: 0.790641/41 [==============================] - 1s 24ms/step - loss: 0.7467 - sparse_categorical_accuracy: 0.7908 - val_loss: 0.5849 - val_sparse_categorical_accuracy: 0.8287
Epoch 4/10
 1/41 [..............................] - ETA: 0s - loss: 0.4047 - sparse_categorical_accuracy: 0.9062 4/41 [=>............................] - ETA: 0s - loss: 0.5827 - sparse_categorical_accuracy: 0.8516 7/41 [====>.........................] - ETA: 0s - loss: 0.6135 - sparse_categorical_accuracy: 0.857110/41 [======>.......................] - ETA: 0s - loss: 0.5973 - sparse_categorical_accuracy: 0.856213/41 [========>.....................] - ETA: 0s - loss: 0.6082 - sparse_categorical_accuracy: 0.838916/41 [==========>...................] - ETA: 0s - loss: 0.6014 - sparse_categorical_accuracy: 0.847719/41 [============>.................] - ETA: 0s - loss: 0.5672 - sparse_categorical_accuracy: 0.865122/41 [===============>..............] - ETA: 0s - loss: 0.5493 - sparse_categorical_accuracy: 0.873625/41 [=================>............] - ETA: 0s - loss: 0.5479 - sparse_categorical_accuracy: 0.872528/41 [===================>..........] - ETA: 0s - loss: 0.5368 - sparse_categorical_accuracy: 0.875031/41 [=====================>........] - ETA: 0s - loss: 0.5306 - sparse_categorical_accuracy: 0.879034/41 [=======================>......] - ETA: 0s - loss: 0.5256 - sparse_categorical_accuracy: 0.879637/41 [==========================>...] - ETA: 0s - loss: 0.5151 - sparse_categorical_accuracy: 0.879240/41 [============================>.] - ETA: 0s - loss: 0.5104 - sparse_categorical_accuracy: 0.878141/41 [==============================] - 1s 25ms/step - loss: 0.5096 - sparse_categorical_accuracy: 0.8786 - val_loss: 0.4373 - val_sparse_categorical_accuracy: 0.9021
Epoch 5/10
 1/41 [..............................] - ETA: 0s - loss: 0.3056 - sparse_categorical_accuracy: 0.9375 4/41 [=>............................] - ETA: 0s - loss: 0.4351 - sparse_categorical_accuracy: 0.8906 7/41 [====>.........................] - ETA: 0s - loss: 0.4785 - sparse_categorical_accuracy: 0.879510/41 [======>.......................] - ETA: 0s - loss: 0.4657 - sparse_categorical_accuracy: 0.878113/41 [========>.....................] - ETA: 0s - loss: 0.4775 - sparse_categorical_accuracy: 0.860616/41 [==========>...................] - ETA: 0s - loss: 0.4734 - sparse_categorical_accuracy: 0.863319/41 [============>.................] - ETA: 0s - loss: 0.4491 - sparse_categorical_accuracy: 0.876622/41 [===============>..............] - ETA: 0s - loss: 0.4358 - sparse_categorical_accuracy: 0.883525/41 [=================>............] - ETA: 0s - loss: 0.4308 - sparse_categorical_accuracy: 0.886328/41 [===================>..........] - ETA: 0s - loss: 0.4240 - sparse_categorical_accuracy: 0.888431/41 [=====================>........] - ETA: 0s - loss: 0.4164 - sparse_categorical_accuracy: 0.894234/41 [=======================>......] - ETA: 0s - loss: 0.4129 - sparse_categorical_accuracy: 0.894337/41 [==========================>...] - ETA: 0s - loss: 0.4038 - sparse_categorical_accuracy: 0.896140/41 [============================>.] - ETA: 0s - loss: 0.4001 - sparse_categorical_accuracy: 0.899241/41 [==============================] - 1s 25ms/step - loss: 0.4003 - sparse_categorical_accuracy: 0.8992 - val_loss: 0.3588 - val_sparse_categorical_accuracy: 0.9144
Epoch 6/10
 1/41 [..............................] - ETA: 0s - loss: 0.2451 - sparse_categorical_accuracy: 0.9375 4/41 [=>............................] - ETA: 0s - loss: 0.3578 - sparse_categorical_accuracy: 0.9141 7/41 [====>.........................] - ETA: 0s - loss: 0.3898 - sparse_categorical_accuracy: 0.924110/41 [======>.......................] - ETA: 0s - loss: 0.3809 - sparse_categorical_accuracy: 0.928113/41 [========>.....................] - ETA: 0s - loss: 0.3886 - sparse_categorical_accuracy: 0.911116/41 [==========>...................] - ETA: 0s - loss: 0.3896 - sparse_categorical_accuracy: 0.910219/41 [============>.................] - ETA: 0s - loss: 0.3664 - sparse_categorical_accuracy: 0.916122/41 [===============>..............] - ETA: 0s - loss: 0.3557 - sparse_categorical_accuracy: 0.920525/41 [=================>............] - ETA: 0s - loss: 0.3478 - sparse_categorical_accuracy: 0.923728/41 [===================>..........] - ETA: 0s - loss: 0.3424 - sparse_categorical_accuracy: 0.923031/41 [=====================>........] - ETA: 0s - loss: 0.3350 - sparse_categorical_accuracy: 0.925434/41 [=======================>......] - ETA: 0s - loss: 0.3313 - sparse_categorical_accuracy: 0.924637/41 [==========================>...] - ETA: 0s - loss: 0.3247 - sparse_categorical_accuracy: 0.926540/41 [============================>.] - ETA: 0s - loss: 0.3222 - sparse_categorical_accuracy: 0.928141/41 [==============================] - 1s 24ms/step - loss: 0.3223 - sparse_categorical_accuracy: 0.9282 - val_loss: 0.3004 - val_sparse_categorical_accuracy: 0.9266
Epoch 7/10
 1/41 [..............................] - ETA: 0s - loss: 0.2192 - sparse_categorical_accuracy: 0.9375 4/41 [=>............................] - ETA: 0s - loss: 0.3014 - sparse_categorical_accuracy: 0.9375 7/41 [====>.........................] - ETA: 0s - loss: 0.3275 - sparse_categorical_accuracy: 0.937510/41 [======>.......................] - ETA: 0s - loss: 0.3199 - sparse_categorical_accuracy: 0.940613/41 [========>.....................] - ETA: 0s - loss: 0.3227 - sparse_categorical_accuracy: 0.932716/41 [==========>...................] - ETA: 0s - loss: 0.3212 - sparse_categorical_accuracy: 0.933619/41 [============>.................] - ETA: 0s - loss: 0.3043 - sparse_categorical_accuracy: 0.935922/41 [===============>..............] - ETA: 0s - loss: 0.2970 - sparse_categorical_accuracy: 0.936125/41 [=================>............] - ETA: 0s - loss: 0.2911 - sparse_categorical_accuracy: 0.938828/41 [===================>..........] - ETA: 0s - loss: 0.2880 - sparse_categorical_accuracy: 0.937531/41 [=====================>........] - ETA: 0s - loss: 0.2817 - sparse_categorical_accuracy: 0.940534/41 [=======================>......] - ETA: 0s - loss: 0.2781 - sparse_categorical_accuracy: 0.939337/41 [==========================>...] - ETA: 0s - loss: 0.2736 - sparse_categorical_accuracy: 0.940040/41 [============================>.] - ETA: 0s - loss: 0.2735 - sparse_categorical_accuracy: 0.940641/41 [==============================] - 1s 24ms/step - loss: 0.2734 - sparse_categorical_accuracy: 0.9405 - val_loss: 0.2520 - val_sparse_categorical_accuracy: 0.9419
Epoch 8/10
 1/41 [..............................] - ETA: 0s - loss: 0.1758 - sparse_categorical_accuracy: 0.9688 4/41 [=>............................] - ETA: 0s - loss: 0.2604 - sparse_categorical_accuracy: 0.9688 7/41 [====>.........................] - ETA: 0s - loss: 0.2861 - sparse_categorical_accuracy: 0.964310/41 [======>.......................] - ETA: 0s - loss: 0.2786 - sparse_categorical_accuracy: 0.962513/41 [========>.....................] - ETA: 0s - loss: 0.2847 - sparse_categorical_accuracy: 0.947116/41 [==========>...................] - ETA: 0s - loss: 0.2796 - sparse_categorical_accuracy: 0.947319/41 [============>.................] - ETA: 0s - loss: 0.2676 - sparse_categorical_accuracy: 0.949022/41 [===============>..............] - ETA: 0s - loss: 0.2603 - sparse_categorical_accuracy: 0.953125/41 [=================>............] - ETA: 0s - loss: 0.2553 - sparse_categorical_accuracy: 0.956328/41 [===================>..........] - ETA: 0s - loss: 0.2529 - sparse_categorical_accuracy: 0.952031/41 [=====================>........] - ETA: 0s - loss: 0.2455 - sparse_categorical_accuracy: 0.954634/41 [=======================>......] - ETA: 0s - loss: 0.2418 - sparse_categorical_accuracy: 0.953137/41 [==========================>...] - ETA: 0s - loss: 0.2374 - sparse_categorical_accuracy: 0.951940/41 [============================>.] - ETA: 0s - loss: 0.2379 - sparse_categorical_accuracy: 0.951641/41 [==============================] - 1s 24ms/step - loss: 0.2377 - sparse_categorical_accuracy: 0.9511 - val_loss: 0.2054 - val_sparse_categorical_accuracy: 0.9633
Epoch 9/10
 1/41 [..............................] - ETA: 0s - loss: 0.1362 - sparse_categorical_accuracy: 1.0000 4/41 [=>............................] - ETA: 0s - loss: 0.2103 - sparse_categorical_accuracy: 0.9766 7/41 [====>.........................] - ETA: 0s - loss: 0.2421 - sparse_categorical_accuracy: 0.973210/41 [======>.......................] - ETA: 0s - loss: 0.2354 - sparse_categorical_accuracy: 0.971913/41 [========>.....................] - ETA: 0s - loss: 0.2384 - sparse_categorical_accuracy: 0.959116/41 [==========>...................] - ETA: 0s - loss: 0.2308 - sparse_categorical_accuracy: 0.960919/41 [============>.................] - ETA: 0s - loss: 0.2215 - sparse_categorical_accuracy: 0.962222/41 [===============>..............] - ETA: 0s - loss: 0.2168 - sparse_categorical_accuracy: 0.964525/41 [=================>............] - ETA: 0s - loss: 0.2134 - sparse_categorical_accuracy: 0.966328/41 [===================>..........] - ETA: 0s - loss: 0.2106 - sparse_categorical_accuracy: 0.963231/41 [=====================>........] - ETA: 0s - loss: 0.2048 - sparse_categorical_accuracy: 0.966734/41 [=======================>......] - ETA: 0s - loss: 0.2016 - sparse_categorical_accuracy: 0.965137/41 [==========================>...] - ETA: 0s - loss: 0.1986 - sparse_categorical_accuracy: 0.964540/41 [============================>.] - ETA: 0s - loss: 0.1997 - sparse_categorical_accuracy: 0.963341/41 [==============================] - 1s 24ms/step - loss: 0.1995 - sparse_categorical_accuracy: 0.9626 - val_loss: 0.1850 - val_sparse_categorical_accuracy: 0.9664
Epoch 10/10
 1/41 [..............................] - ETA: 0s - loss: 0.1087 - sparse_categorical_accuracy: 1.0000 4/41 [=>............................] - ETA: 0s - loss: 0.1913 - sparse_categorical_accuracy: 0.9766 7/41 [====>.........................] - ETA: 0s - loss: 0.2257 - sparse_categorical_accuracy: 0.968810/41 [======>.......................] - ETA: 0s - loss: 0.2156 - sparse_categorical_accuracy: 0.968813/41 [========>.....................] - ETA: 0s - loss: 0.2222 - sparse_categorical_accuracy: 0.956716/41 [==========>...................] - ETA: 0s - loss: 0.2148 - sparse_categorical_accuracy: 0.957019/41 [============>.................] - ETA: 0s - loss: 0.2071 - sparse_categorical_accuracy: 0.955622/41 [===============>..............] - ETA: 0s - loss: 0.2022 - sparse_categorical_accuracy: 0.957425/41 [=================>............] - ETA: 0s - loss: 0.1980 - sparse_categorical_accuracy: 0.957528/41 [===================>..........] - ETA: 0s - loss: 0.1943 - sparse_categorical_accuracy: 0.957631/41 [=====================>........] - ETA: 0s - loss: 0.1887 - sparse_categorical_accuracy: 0.961734/41 [=======================>......] - ETA: 0s - loss: 0.1860 - sparse_categorical_accuracy: 0.960537/41 [==========================>...] - ETA: 0s - loss: 0.1843 - sparse_categorical_accuracy: 0.959540/41 [============================>.] - ETA: 0s - loss: 0.1864 - sparse_categorical_accuracy: 0.957841/41 [==============================] - 1s 24ms/step - loss: 0.1862 - sparse_categorical_accuracy: 0.9580 - val_loss: 0.1688 - val_sparse_categorical_accuracy: 0.9694
Training history saved at model/qat/float16/history.npy
Model saved in Keras format at model/qat/float16/celestial_bodies_classifier_model_qat_float16.keras
Converting model to ONNX...
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1731532459.253897  876119 devices.cc:76] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 0 (Note: TensorFlow was not compiled with CUDA or ROCm support)
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1731532459.253970  876119 single_machine.cc:361] Starting new session
I0000 00:00:1731532459.324870  876119 devices.cc:76] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 0 (Note: TensorFlow was not compiled with CUDA or ROCm support)
I0000 00:00:1731532459.324938  876119 single_machine.cc:361] Starting new session
I0000 00:00:1731532459.370232  876119 mlir_graph_optimization_pass.cc:401] MLIR V1 optimization pass is not enabled
Model converted to ONNX and saved at model/qat/float16/celestial_bodies_classifier_model_qat_float16.onnx
Applying dynamic quantization to ONNX model...
WARNING:root:Please consider to run pre-processing before quantization. Refer to example: https://github.com/microsoft/onnxruntime-inference-examples/blob/main/quantization/image_classification/cpu/ReadMe.md 
WARNING:root:Please check if the model is already quantized. Note you don't need to quantize a QAT model. OnnxRuntime support to run QAT model directly.
Quantized ONNX model saved at model/qat/float16/celestial_bodies_classifier_model_qat_float16_quantized.onnx
Saving ONNX model with BentoML...
Quantized ONNX model successfully saved to BentoML store.
BentoML model exported at model/qat/float16
Updating lock file 'dvc.lock'

Running stage 'qat_integer_train':
> python3.11 a_guide_to_mlops/train/qat/train_qat_integer.py data/prepared model/qat/integer
Loading datasets...
Datasets loaded successfully.
Defining model...
Annotating model for QAT and applying quantization...
Compiling quantized model...
WARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.Adam` runs slowly on M1/M2 Macs, please use the legacy TF-Keras optimizer instead, located at `tf.keras.optimizers.legacy.Adam`.
Starting QAT model training...
Epoch 1/10
 1/41 [..............................] - ETA: 23s - loss: 2.3993 - sparse_categorical_accuracy: 0.0625 4/41 [=>............................] - ETA: 0s - loss: 2.3308 - sparse_categorical_accuracy: 0.1250  7/41 [====>.........................] - ETA: 0s - loss: 2.3602 - sparse_categorical_accuracy: 0.098210/41 [======>.......................] - ETA: 0s - loss: 2.3160 - sparse_categorical_accuracy: 0.106313/41 [========>.....................] - ETA: 0s - loss: 2.2920 - sparse_categorical_accuracy: 0.108216/41 [==========>...................] - ETA: 0s - loss: 2.2649 - sparse_categorical_accuracy: 0.125019/41 [============>.................] - ETA: 0s - loss: 2.2394 - sparse_categorical_accuracy: 0.139822/41 [===============>..............] - ETA: 0s - loss: 2.2180 - sparse_categorical_accuracy: 0.176125/41 [=================>............] - ETA: 0s - loss: 2.2006 - sparse_categorical_accuracy: 0.181328/41 [===================>..........] - ETA: 0s - loss: 2.1789 - sparse_categorical_accuracy: 0.207631/41 [=====================>........] - ETA: 0s - loss: 2.1478 - sparse_categorical_accuracy: 0.240934/41 [=======================>......] - ETA: 0s - loss: 2.1185 - sparse_categorical_accuracy: 0.266537/41 [==========================>...] - ETA: 0s - loss: 2.0869 - sparse_categorical_accuracy: 0.288940/41 [============================>.] - ETA: 0s - loss: 2.0554 - sparse_categorical_accuracy: 0.310941/41 [==============================] - 2s 26ms/step - loss: 2.0477 - sparse_categorical_accuracy: 0.3115 - val_loss: 1.6760 - val_sparse_categorical_accuracy: 0.5627
Epoch 2/10
 1/41 [..............................] - ETA: 0s - loss: 1.3908 - sparse_categorical_accuracy: 0.7500 4/41 [=>............................] - ETA: 0s - loss: 1.5220 - sparse_categorical_accuracy: 0.5391 7/41 [====>.........................] - ETA: 0s - loss: 1.5396 - sparse_categorical_accuracy: 0.486610/41 [======>.......................] - ETA: 0s - loss: 1.5077 - sparse_categorical_accuracy: 0.509413/41 [========>.....................] - ETA: 0s - loss: 1.5022 - sparse_categorical_accuracy: 0.497616/41 [==========>...................] - ETA: 0s - loss: 1.4810 - sparse_categorical_accuracy: 0.515619/41 [============>.................] - ETA: 0s - loss: 1.4242 - sparse_categorical_accuracy: 0.547722/41 [===============>..............] - ETA: 0s - loss: 1.3778 - sparse_categorical_accuracy: 0.555425/41 [=================>............] - ETA: 0s - loss: 1.3591 - sparse_categorical_accuracy: 0.557528/41 [===================>..........] - ETA: 0s - loss: 1.3305 - sparse_categorical_accuracy: 0.577031/41 [=====================>........] - ETA: 0s - loss: 1.3058 - sparse_categorical_accuracy: 0.586734/41 [=======================>......] - ETA: 0s - loss: 1.2831 - sparse_categorical_accuracy: 0.594737/41 [==========================>...] - ETA: 0s - loss: 1.2517 - sparse_categorical_accuracy: 0.601440/41 [============================>.] - ETA: 0s - loss: 1.2286 - sparse_categorical_accuracy: 0.605541/41 [==============================] - 1s 24ms/step - loss: 1.2207 - sparse_categorical_accuracy: 0.6084 - val_loss: 0.9167 - val_sparse_categorical_accuracy: 0.7339
Epoch 3/10
 1/41 [..............................] - ETA: 0s - loss: 0.7454 - sparse_categorical_accuracy: 0.7500 4/41 [=>............................] - ETA: 0s - loss: 0.9164 - sparse_categorical_accuracy: 0.7188 7/41 [====>.........................] - ETA: 0s - loss: 0.9237 - sparse_categorical_accuracy: 0.705410/41 [======>.......................] - ETA: 0s - loss: 0.9120 - sparse_categorical_accuracy: 0.696913/41 [========>.....................] - ETA: 0s - loss: 0.9247 - sparse_categorical_accuracy: 0.687516/41 [==========>...................] - ETA: 0s - loss: 0.9061 - sparse_categorical_accuracy: 0.714819/41 [============>.................] - ETA: 0s - loss: 0.8606 - sparse_categorical_accuracy: 0.738522/41 [===============>..............] - ETA: 0s - loss: 0.8306 - sparse_categorical_accuracy: 0.758525/41 [=================>............] - ETA: 0s - loss: 0.8223 - sparse_categorical_accuracy: 0.763828/41 [===================>..........] - ETA: 0s - loss: 0.8066 - sparse_categorical_accuracy: 0.771231/41 [=====================>........] - ETA: 0s - loss: 0.7896 - sparse_categorical_accuracy: 0.779234/41 [=======================>......] - ETA: 0s - loss: 0.7806 - sparse_categorical_accuracy: 0.782237/41 [==========================>...] - ETA: 0s - loss: 0.7602 - sparse_categorical_accuracy: 0.789740/41 [============================>.] - ETA: 0s - loss: 0.7495 - sparse_categorical_accuracy: 0.790641/41 [==============================] - 1s 25ms/step - loss: 0.7467 - sparse_categorical_accuracy: 0.7908 - val_loss: 0.5849 - val_sparse_categorical_accuracy: 0.8287
Epoch 4/10
 1/41 [..............................] - ETA: 0s - loss: 0.4047 - sparse_categorical_accuracy: 0.9062 4/41 [=>............................] - ETA: 0s - loss: 0.5827 - sparse_categorical_accuracy: 0.8516 7/41 [====>.........................] - ETA: 0s - loss: 0.6135 - sparse_categorical_accuracy: 0.857110/41 [======>.......................] - ETA: 0s - loss: 0.5973 - sparse_categorical_accuracy: 0.856213/41 [========>.....................] - ETA: 0s - loss: 0.6082 - sparse_categorical_accuracy: 0.838916/41 [==========>...................] - ETA: 0s - loss: 0.6014 - sparse_categorical_accuracy: 0.847719/41 [============>.................] - ETA: 0s - loss: 0.5672 - sparse_categorical_accuracy: 0.865122/41 [===============>..............] - ETA: 0s - loss: 0.5493 - sparse_categorical_accuracy: 0.873625/41 [=================>............] - ETA: 0s - loss: 0.5479 - sparse_categorical_accuracy: 0.872528/41 [===================>..........] - ETA: 0s - loss: 0.5368 - sparse_categorical_accuracy: 0.875031/41 [=====================>........] - ETA: 0s - loss: 0.5306 - sparse_categorical_accuracy: 0.879034/41 [=======================>......] - ETA: 0s - loss: 0.5256 - sparse_categorical_accuracy: 0.879637/41 [==========================>...] - ETA: 0s - loss: 0.5151 - sparse_categorical_accuracy: 0.879240/41 [============================>.] - ETA: 0s - loss: 0.5104 - sparse_categorical_accuracy: 0.878141/41 [==============================] - 1s 25ms/step - loss: 0.5096 - sparse_categorical_accuracy: 0.8786 - val_loss: 0.4373 - val_sparse_categorical_accuracy: 0.9021
Epoch 5/10
 1/41 [..............................] - ETA: 0s - loss: 0.3056 - sparse_categorical_accuracy: 0.9375 4/41 [=>............................] - ETA: 0s - loss: 0.4351 - sparse_categorical_accuracy: 0.8906 7/41 [====>.........................] - ETA: 0s - loss: 0.4785 - sparse_categorical_accuracy: 0.879510/41 [======>.......................] - ETA: 0s - loss: 0.4657 - sparse_categorical_accuracy: 0.878113/41 [========>.....................] - ETA: 0s - loss: 0.4775 - sparse_categorical_accuracy: 0.860616/41 [==========>...................] - ETA: 0s - loss: 0.4734 - sparse_categorical_accuracy: 0.863319/41 [============>.................] - ETA: 0s - loss: 0.4491 - sparse_categorical_accuracy: 0.876622/41 [===============>..............] - ETA: 0s - loss: 0.4358 - sparse_categorical_accuracy: 0.883525/41 [=================>............] - ETA: 0s - loss: 0.4308 - sparse_categorical_accuracy: 0.886328/41 [===================>..........] - ETA: 0s - loss: 0.4240 - sparse_categorical_accuracy: 0.888431/41 [=====================>........] - ETA: 0s - loss: 0.4164 - sparse_categorical_accuracy: 0.894234/41 [=======================>......] - ETA: 0s - loss: 0.4129 - sparse_categorical_accuracy: 0.894337/41 [==========================>...] - ETA: 0s - loss: 0.4038 - sparse_categorical_accuracy: 0.896140/41 [============================>.] - ETA: 0s - loss: 0.4001 - sparse_categorical_accuracy: 0.899241/41 [==============================] - 1s 25ms/step - loss: 0.4003 - sparse_categorical_accuracy: 0.8992 - val_loss: 0.3588 - val_sparse_categorical_accuracy: 0.9144
Epoch 6/10
 1/41 [..............................] - ETA: 0s - loss: 0.2451 - sparse_categorical_accuracy: 0.9375 4/41 [=>............................] - ETA: 0s - loss: 0.3578 - sparse_categorical_accuracy: 0.9141 7/41 [====>.........................] - ETA: 0s - loss: 0.3898 - sparse_categorical_accuracy: 0.924110/41 [======>.......................] - ETA: 0s - loss: 0.3809 - sparse_categorical_accuracy: 0.928113/41 [========>.....................] - ETA: 0s - loss: 0.3886 - sparse_categorical_accuracy: 0.911116/41 [==========>...................] - ETA: 0s - loss: 0.3896 - sparse_categorical_accuracy: 0.910219/41 [============>.................] - ETA: 0s - loss: 0.3664 - sparse_categorical_accuracy: 0.916122/41 [===============>..............] - ETA: 0s - loss: 0.3557 - sparse_categorical_accuracy: 0.920525/41 [=================>............] - ETA: 0s - loss: 0.3478 - sparse_categorical_accuracy: 0.923728/41 [===================>..........] - ETA: 0s - loss: 0.3424 - sparse_categorical_accuracy: 0.923031/41 [=====================>........] - ETA: 0s - loss: 0.3350 - sparse_categorical_accuracy: 0.925434/41 [=======================>......] - ETA: 0s - loss: 0.3313 - sparse_categorical_accuracy: 0.924637/41 [==========================>...] - ETA: 0s - loss: 0.3247 - sparse_categorical_accuracy: 0.926540/41 [============================>.] - ETA: 0s - loss: 0.3222 - sparse_categorical_accuracy: 0.928141/41 [==============================] - 1s 25ms/step - loss: 0.3223 - sparse_categorical_accuracy: 0.9282 - val_loss: 0.3004 - val_sparse_categorical_accuracy: 0.9266
Epoch 7/10
 1/41 [..............................] - ETA: 0s - loss: 0.2192 - sparse_categorical_accuracy: 0.9375 4/41 [=>............................] - ETA: 0s - loss: 0.3014 - sparse_categorical_accuracy: 0.9375 7/41 [====>.........................] - ETA: 0s - loss: 0.3275 - sparse_categorical_accuracy: 0.937510/41 [======>.......................] - ETA: 0s - loss: 0.3199 - sparse_categorical_accuracy: 0.940613/41 [========>.....................] - ETA: 0s - loss: 0.3227 - sparse_categorical_accuracy: 0.932716/41 [==========>...................] - ETA: 0s - loss: 0.3212 - sparse_categorical_accuracy: 0.933619/41 [============>.................] - ETA: 0s - loss: 0.3043 - sparse_categorical_accuracy: 0.935922/41 [===============>..............] - ETA: 0s - loss: 0.2970 - sparse_categorical_accuracy: 0.936125/41 [=================>............] - ETA: 0s - loss: 0.2911 - sparse_categorical_accuracy: 0.938828/41 [===================>..........] - ETA: 0s - loss: 0.2880 - sparse_categorical_accuracy: 0.937531/41 [=====================>........] - ETA: 0s - loss: 0.2817 - sparse_categorical_accuracy: 0.940534/41 [=======================>......] - ETA: 0s - loss: 0.2781 - sparse_categorical_accuracy: 0.939337/41 [==========================>...] - ETA: 0s - loss: 0.2736 - sparse_categorical_accuracy: 0.940040/41 [============================>.] - ETA: 0s - loss: 0.2735 - sparse_categorical_accuracy: 0.940641/41 [==============================] - 1s 25ms/step - loss: 0.2734 - sparse_categorical_accuracy: 0.9405 - val_loss: 0.2520 - val_sparse_categorical_accuracy: 0.9419
Epoch 8/10
 1/41 [..............................] - ETA: 0s - loss: 0.1758 - sparse_categorical_accuracy: 0.9688 4/41 [=>............................] - ETA: 0s - loss: 0.2604 - sparse_categorical_accuracy: 0.9688 7/41 [====>.........................] - ETA: 0s - loss: 0.2861 - sparse_categorical_accuracy: 0.964310/41 [======>.......................] - ETA: 0s - loss: 0.2786 - sparse_categorical_accuracy: 0.962513/41 [========>.....................] - ETA: 0s - loss: 0.2847 - sparse_categorical_accuracy: 0.947116/41 [==========>...................] - ETA: 0s - loss: 0.2796 - sparse_categorical_accuracy: 0.947319/41 [============>.................] - ETA: 0s - loss: 0.2676 - sparse_categorical_accuracy: 0.949022/41 [===============>..............] - ETA: 0s - loss: 0.2603 - sparse_categorical_accuracy: 0.953125/41 [=================>............] - ETA: 0s - loss: 0.2553 - sparse_categorical_accuracy: 0.956328/41 [===================>..........] - ETA: 0s - loss: 0.2529 - sparse_categorical_accuracy: 0.952031/41 [=====================>........] - ETA: 0s - loss: 0.2455 - sparse_categorical_accuracy: 0.954634/41 [=======================>......] - ETA: 0s - loss: 0.2418 - sparse_categorical_accuracy: 0.953137/41 [==========================>...] - ETA: 0s - loss: 0.2374 - sparse_categorical_accuracy: 0.951940/41 [============================>.] - ETA: 0s - loss: 0.2379 - sparse_categorical_accuracy: 0.951641/41 [==============================] - 1s 25ms/step - loss: 0.2377 - sparse_categorical_accuracy: 0.9511 - val_loss: 0.2054 - val_sparse_categorical_accuracy: 0.9633
Epoch 9/10
 1/41 [..............................] - ETA: 0s - loss: 0.1362 - sparse_categorical_accuracy: 1.0000 4/41 [=>............................] - ETA: 0s - loss: 0.2103 - sparse_categorical_accuracy: 0.9766 7/41 [====>.........................] - ETA: 0s - loss: 0.2421 - sparse_categorical_accuracy: 0.973210/41 [======>.......................] - ETA: 0s - loss: 0.2354 - sparse_categorical_accuracy: 0.971913/41 [========>.....................] - ETA: 0s - loss: 0.2384 - sparse_categorical_accuracy: 0.959116/41 [==========>...................] - ETA: 0s - loss: 0.2308 - sparse_categorical_accuracy: 0.960919/41 [============>.................] - ETA: 0s - loss: 0.2215 - sparse_categorical_accuracy: 0.962222/41 [===============>..............] - ETA: 0s - loss: 0.2168 - sparse_categorical_accuracy: 0.964525/41 [=================>............] - ETA: 0s - loss: 0.2134 - sparse_categorical_accuracy: 0.966328/41 [===================>..........] - ETA: 0s - loss: 0.2106 - sparse_categorical_accuracy: 0.963231/41 [=====================>........] - ETA: 0s - loss: 0.2048 - sparse_categorical_accuracy: 0.966734/41 [=======================>......] - ETA: 0s - loss: 0.2016 - sparse_categorical_accuracy: 0.965137/41 [==========================>...] - ETA: 0s - loss: 0.1986 - sparse_categorical_accuracy: 0.964540/41 [============================>.] - ETA: 0s - loss: 0.1997 - sparse_categorical_accuracy: 0.963341/41 [==============================] - 1s 25ms/step - loss: 0.1995 - sparse_categorical_accuracy: 0.9626 - val_loss: 0.1850 - val_sparse_categorical_accuracy: 0.9664
Epoch 10/10
 1/41 [..............................] - ETA: 0s - loss: 0.1087 - sparse_categorical_accuracy: 1.0000 4/41 [=>............................] - ETA: 0s - loss: 0.1913 - sparse_categorical_accuracy: 0.9766 7/41 [====>.........................] - ETA: 0s - loss: 0.2257 - sparse_categorical_accuracy: 0.968810/41 [======>.......................] - ETA: 0s - loss: 0.2156 - sparse_categorical_accuracy: 0.968813/41 [========>.....................] - ETA: 0s - loss: 0.2222 - sparse_categorical_accuracy: 0.956716/41 [==========>...................] - ETA: 0s - loss: 0.2148 - sparse_categorical_accuracy: 0.957019/41 [============>.................] - ETA: 0s - loss: 0.2071 - sparse_categorical_accuracy: 0.955622/41 [===============>..............] - ETA: 0s - loss: 0.2022 - sparse_categorical_accuracy: 0.957425/41 [=================>............] - ETA: 0s - loss: 0.1980 - sparse_categorical_accuracy: 0.957527/41 [==================>...........] - ETA: 0s - loss: 0.1976 - sparse_categorical_accuracy: 0.956029/41 [====================>.........] - ETA: 0s - loss: 0.1924 - sparse_categorical_accuracy: 0.959132/41 [======================>.......] - ETA: 0s - loss: 0.1885 - sparse_categorical_accuracy: 0.960935/41 [========================>.....] - ETA: 0s - loss: 0.1859 - sparse_categorical_accuracy: 0.959838/41 [==========================>...] - ETA: 0s - loss: 0.1851 - sparse_categorical_accuracy: 0.958941/41 [==============================] - ETA: 0s - loss: 0.1862 - sparse_categorical_accuracy: 0.958041/41 [==============================] - 1s 25ms/step - loss: 0.1862 - sparse_categorical_accuracy: 0.9580 - val_loss: 0.1688 - val_sparse_categorical_accuracy: 0.9694
Saving model in Keras format...
Model saved in Keras format at model/qat/integer/celestial_bodies_classifier_qat_integer.keras
Converting quantized model to ONNX...
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1731532477.879641  877920 devices.cc:76] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 0 (Note: TensorFlow was not compiled with CUDA or ROCm support)
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1731532477.879727  877920 single_machine.cc:361] Starting new session
I0000 00:00:1731532477.953412  877920 devices.cc:76] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 0 (Note: TensorFlow was not compiled with CUDA or ROCm support)
I0000 00:00:1731532477.953501  877920 single_machine.cc:361] Starting new session
I0000 00:00:1731532477.994264  877920 mlir_graph_optimization_pass.cc:401] MLIR V1 optimization pass is not enabled
Model converted to ONNX and saved at model/qat/integer/celestial_bodies_classifier_qat_integer.onnx
Saving the ONNX model with BentoML...
BentoML model exported successfully to model/qat/integer/celestial_bodies_classifier_model.bentomodel
Model training history saved at model/qat/integer/history.npy
Updating lock file 'dvc.lock'

Running stage 'evaluate_baseline':
> python3.11 a_guide_to_mlops/evaluate.py model/baseline data/prepared
Loading model 'celestial_bodies_classifier_model' from BentoML...
Model 'celestial_bodies_classifier_model' successfully loaded from BentoML store.
Evaluating model on test dataset...
2024-11-13 22:14:46.544065: I tensorflow/core/framework/local_rendezvous.cc:405] Local rendezvous is aborting with status: OUT_OF_RANGE: End of sequence
/Users/fabien/Library/CloudStorage/GoogleDrive-roth.fabien@gmail.com/My Drive/MSC_Datascience/02 - Courses/TSM-MachLeData/a-guide-to-mlops/.venv/lib/python3.11/site-packages/sklearn/metrics/_classification.py:2956: UserWarning: The y_pred values do not sum to one. Make sure to pass probabilities.
  warnings.warn(
2024-11-13 22:14:46.984872: I tensorflow/core/framework/local_rendezvous.cc:405] Local rendezvous is aborting with status: OUT_OF_RANGE: End of sequence
Validation loss: 0.13
Validation accuracy: 96.94%

Evaluation metrics and plot files saved at /Users/fabien/Library/CloudStorage/GoogleDrive-roth.fabien@gmail.com/My Drive/MSC_Datascience/02 - Courses/TSM-MachLeData/a-guide-to-mlops/evaluation/baseline
Updating lock file 'dvc.lock'

Running stage 'evaluate_ptq_dynamic':
> python3.11 a_guide_to_mlops/evaluate.py model/ptq/dynamic data/prepared
Loading model 'celestial_bodies_classifier_model' from BentoML...
Model 'celestial_bodies_classifier_model' successfully loaded from BentoML store.
Evaluating model on test dataset...
2024-11-13 22:14:52.405311: I tensorflow/core/framework/local_rendezvous.cc:405] Local rendezvous is aborting with status: OUT_OF_RANGE: End of sequence
/Users/fabien/Library/CloudStorage/GoogleDrive-roth.fabien@gmail.com/My Drive/MSC_Datascience/02 - Courses/TSM-MachLeData/a-guide-to-mlops/.venv/lib/python3.11/site-packages/sklearn/metrics/_classification.py:2956: UserWarning: The y_pred values do not sum to one. Make sure to pass probabilities.
  warnings.warn(
2024-11-13 22:14:52.831678: I tensorflow/core/framework/local_rendezvous.cc:405] Local rendezvous is aborting with status: OUT_OF_RANGE: End of sequence
Validation loss: 0.13
Validation accuracy: 96.94%

Evaluation metrics and plot files saved at /Users/fabien/Library/CloudStorage/GoogleDrive-roth.fabien@gmail.com/My Drive/MSC_Datascience/02 - Courses/TSM-MachLeData/a-guide-to-mlops/evaluation/ptq/dynamic
Updating lock file 'dvc.lock'

Running stage 'evaluate_ptq_float16':
> python3.11 a_guide_to_mlops/evaluate.py model/ptq/float16 data/prepared
Loading model 'celestial_bodies_classifier_model' from BentoML...
Model 'celestial_bodies_classifier_model' successfully loaded from BentoML store.
Evaluating model on test dataset...
2024-11-13 22:14:58.380712: I tensorflow/core/framework/local_rendezvous.cc:405] Local rendezvous is aborting with status: OUT_OF_RANGE: End of sequence
/Users/fabien/Library/CloudStorage/GoogleDrive-roth.fabien@gmail.com/My Drive/MSC_Datascience/02 - Courses/TSM-MachLeData/a-guide-to-mlops/.venv/lib/python3.11/site-packages/sklearn/metrics/_classification.py:2956: UserWarning: The y_pred values do not sum to one. Make sure to pass probabilities.
  warnings.warn(
2024-11-13 22:14:58.819398: I tensorflow/core/framework/local_rendezvous.cc:405] Local rendezvous is aborting with status: OUT_OF_RANGE: End of sequence
Validation loss: 0.13
Validation accuracy: 96.94%

Evaluation metrics and plot files saved at /Users/fabien/Library/CloudStorage/GoogleDrive-roth.fabien@gmail.com/My Drive/MSC_Datascience/02 - Courses/TSM-MachLeData/a-guide-to-mlops/evaluation/ptq/float16
Updating lock file 'dvc.lock'

Running stage 'evaluate_ptq_integer':
> python3.11 a_guide_to_mlops/evaluate.py model/ptq/integer data/prepared
Loading model 'celestial_bodies_classifier_model' from BentoML...
Model 'celestial_bodies_classifier_model' successfully loaded from BentoML store.
Evaluating model on test dataset...
2024-11-13 22:15:04.354574: I tensorflow/core/framework/local_rendezvous.cc:405] Local rendezvous is aborting with status: OUT_OF_RANGE: End of sequence
/Users/fabien/Library/CloudStorage/GoogleDrive-roth.fabien@gmail.com/My Drive/MSC_Datascience/02 - Courses/TSM-MachLeData/a-guide-to-mlops/.venv/lib/python3.11/site-packages/sklearn/metrics/_classification.py:2956: UserWarning: The y_pred values do not sum to one. Make sure to pass probabilities.
  warnings.warn(
2024-11-13 22:15:04.801134: I tensorflow/core/framework/local_rendezvous.cc:405] Local rendezvous is aborting with status: OUT_OF_RANGE: End of sequence
Validation loss: 0.13
Validation accuracy: 96.94%

Evaluation metrics and plot files saved at /Users/fabien/Library/CloudStorage/GoogleDrive-roth.fabien@gmail.com/My Drive/MSC_Datascience/02 - Courses/TSM-MachLeData/a-guide-to-mlops/evaluation/ptq/integer
Updating lock file 'dvc.lock'

Running stage 'evaluate_qat_dynamic':
> python3.11 a_guide_to_mlops/evaluate.py model/qat/dynamic data/prepared
Loading model 'celestial_bodies_classifier_model' from BentoML...
Model 'celestial_bodies_classifier_model' successfully loaded from BentoML store.
Evaluating model on test dataset...
2024-11-13 22:15:10.280592: I tensorflow/core/framework/local_rendezvous.cc:405] Local rendezvous is aborting with status: OUT_OF_RANGE: End of sequence
/Users/fabien/Library/CloudStorage/GoogleDrive-roth.fabien@gmail.com/My Drive/MSC_Datascience/02 - Courses/TSM-MachLeData/a-guide-to-mlops/.venv/lib/python3.11/site-packages/sklearn/metrics/_classification.py:2956: UserWarning: The y_pred values do not sum to one. Make sure to pass probabilities.
  warnings.warn(
2024-11-13 22:15:10.678385: I tensorflow/core/framework/local_rendezvous.cc:405] Local rendezvous is aborting with status: OUT_OF_RANGE: End of sequence
Validation loss: 0.13
Validation accuracy: 96.94%

Evaluation metrics and plot files saved at /Users/fabien/Library/CloudStorage/GoogleDrive-roth.fabien@gmail.com/My Drive/MSC_Datascience/02 - Courses/TSM-MachLeData/a-guide-to-mlops/evaluation/qat/dynamic
Updating lock file 'dvc.lock'

Running stage 'evaluate_qat_float16':
> python3.11 a_guide_to_mlops/evaluate.py model/qat/float16 data/prepared
Loading model 'celestial_bodies_classifier_model' from BentoML...
Model 'celestial_bodies_classifier_model' successfully loaded from BentoML store.
Evaluating model on test dataset...
2024-11-13 22:15:16.038632: I tensorflow/core/framework/local_rendezvous.cc:405] Local rendezvous is aborting with status: OUT_OF_RANGE: End of sequence
/Users/fabien/Library/CloudStorage/GoogleDrive-roth.fabien@gmail.com/My Drive/MSC_Datascience/02 - Courses/TSM-MachLeData/a-guide-to-mlops/.venv/lib/python3.11/site-packages/sklearn/metrics/_classification.py:2956: UserWarning: The y_pred values do not sum to one. Make sure to pass probabilities.
  warnings.warn(
2024-11-13 22:15:16.521320: I tensorflow/core/framework/local_rendezvous.cc:405] Local rendezvous is aborting with status: OUT_OF_RANGE: End of sequence
Validation loss: 0.13
Validation accuracy: 96.94%

Evaluation metrics and plot files saved at /Users/fabien/Library/CloudStorage/GoogleDrive-roth.fabien@gmail.com/My Drive/MSC_Datascience/02 - Courses/TSM-MachLeData/a-guide-to-mlops/evaluation/qat/float16
Updating lock file 'dvc.lock'

Running stage 'evaluate_qat_integer':
> python3.11 a_guide_to_mlops/evaluate.py model/qat/integer data/prepared
Loading model 'celestial_bodies_classifier_model' from BentoML...
Model 'celestial_bodies_classifier_model' successfully loaded from BentoML store.
Evaluating model on test dataset...
2024-11-13 22:15:21.854108: I tensorflow/core/framework/local_rendezvous.cc:405] Local rendezvous is aborting with status: OUT_OF_RANGE: End of sequence
/Users/fabien/Library/CloudStorage/GoogleDrive-roth.fabien@gmail.com/My Drive/MSC_Datascience/02 - Courses/TSM-MachLeData/a-guide-to-mlops/.venv/lib/python3.11/site-packages/sklearn/metrics/_classification.py:2956: UserWarning: The y_pred values do not sum to one. Make sure to pass probabilities.
  warnings.warn(
2024-11-13 22:15:22.330393: I tensorflow/core/framework/local_rendezvous.cc:405] Local rendezvous is aborting with status: OUT_OF_RANGE: End of sequence
Validation loss: 0.13
Validation accuracy: 96.94%

Evaluation metrics and plot files saved at /Users/fabien/Library/CloudStorage/GoogleDrive-roth.fabien@gmail.com/My Drive/MSC_Datascience/02 - Courses/TSM-MachLeData/a-guide-to-mlops/evaluation/qat/integer
Updating lock file 'dvc.lock'

To track the changes with git, run:

	git add evaluation/ptq/integer/.gitignore evaluation/ptq/float16/plots/.gitignore dvc.lock data/raw.dvc evaluation/ptq/integer/plots/.gitignore evaluation/ptq/float16/.gitignore

To enable auto staging, run:

	dvc config core.autostage true
Use `dvc push` to send your updates to remote storage.
